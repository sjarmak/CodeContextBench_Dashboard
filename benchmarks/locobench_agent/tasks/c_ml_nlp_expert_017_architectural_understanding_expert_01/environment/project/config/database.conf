# ==============================================================================
#  LexiLearn MVC Orchestrator – Database Configuration
# ------------------------------------------------------------------------------
#  File:        lexilearn_orchestrator/config/database.conf
#  Purpose:     Centralized database configuration for all Controller / Model
#               services (data-ingestion workers, feature store, experiment
#               tracker, model registry, and real-time dashboard back-ends).
#
#  Format:      INI-like key/value pairs with “dot” notation for nested paths.
#               This file is parsed by the internal Config Loader (src/utils/
#               config_loader.c) which supports environment overrides through
#               the LEXILEARN_ENV environment variable (dev | test | prod).
#
#  NOTE:        • Secrets (passwords, SSL keys) should be managed via your
#                 organization’s secret-management solution (e.g., HashiCorp
#                 Vault, AWS Secrets Manager).  The values below are strictly
#                 placeholders for local development.
#               • All time values are expressed in seconds unless noted.
#
# ==============================================================================


###############################################################################
# GLOBAL DEFAULTS
###############################################################################
[default]
driver                = postgres                 ; Supported: postgres | mysql
host                  = 127.0.0.1
port                  = 5432
database              = lexilearn
username              = lexilearn_app
password              = CHANGE_ME                ; → Overridden by secrets mgr
schema                = public

# Connection pool settings (used by HikariCP wrapper in C layer)
pool.min              = 2
pool.max              = 32
pool.idle_timeout     = 300
pool.acquire_timeout  = 30

# SSL / TLS
ssl.enabled           = false                    ; true in production
ssl.mode              = require                 ; verify-full | verify-ca | require
ssl.root_cert         = /etc/ssl/certs/ca.pem
ssl.client_cert       = /etc/ssl/certs/client.pem
ssl.client_key        = /etc/ssl/private/client.key

# Performance / timeouts
statement_timeout     = 60                       ; Cancel query after 60s
lock_timeout          = 15
tcp_keepalives_idle   = 30
tcp_keepalives_intvl  = 10
tcp_keepalives_count  = 5

# Observability
log_sql               = false                    ; Extensive query logging
log_level             = INFO                     ; DEBUG | INFO | WARN | ERROR

# Feature flags
feature_store.enabled = true
mlflow.enabled        = true
registry.enabled      = true
###############################################################################



###############################################################################
# DEVELOPMENT ENVIRONMENT
###############################################################################
[dev]
host                  = 127.0.0.1
database              = lexilearn_dev
username              = lexilearn_dev
password              = dev_password
ssl.enabled           = false
log_sql               = true
pool.min              = 1
pool.max              = 10
log_level             = DEBUG



###############################################################################
# TEST / CI ENVIRONMENT
###############################################################################
[test]
host                  = 127.0.0.1
database              = lexilearn_test
username              = lexilearn_ci
password              = ci_password
ssl.enabled           = false
statement_timeout     = 30
lock_timeout          = 5
pool.min              = 1
pool.max              = 5
log_level             = WARN



###############################################################################
# PRODUCTION ENVIRONMENT
###############################################################################
[prod]
host                  = db.prod.lexilearn.edu
port                  = 5432
database              = lexilearn_prod
username              = lexilearn_svc
password              = ${DB_LexiLearn_SVC_PASSWORD}    ; Fetched at runtime
schema                = live
ssl.enabled           = true
ssl.mode              = verify-full
ssl.root_cert         = /etc/lexilearn/ssl/ca.pem
ssl.client_cert       = /etc/lexilearn/ssl/lexilearn-svc.crt
ssl.client_key        = /etc/lexilearn/ssl/lexilearn-svc.key

pool.min              = 8
pool.max              = 64
pool.idle_timeout     = 180
pool.acquire_timeout  = 60

statement_timeout     = 120
lock_timeout          = 30

# High-availability / replication settings
replication.role      = primary                  ; primary | replica
replication.readonly  = false                    ; true on replicas

# Observability
log_sql               = false                    ; Enable in an emergency only
log_level             = INFO



###############################################################################
# END OF FILE
###############################################################################