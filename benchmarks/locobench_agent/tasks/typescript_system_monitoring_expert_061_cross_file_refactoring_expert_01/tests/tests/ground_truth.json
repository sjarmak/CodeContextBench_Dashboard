{
  "ground_truth": "The expected outcome is a codebase where all alerting logic is handled by a single service.\n\n**Key Changes:**\n\n1.  **New Files Created:**\n    - `src/services/notificationService.ts`: Contains the `NotificationService` class, `NotificationChannel` interface, `AlertMessage` type, and concrete channel implementations (`EmailChannel`, `WebhookChannel`, `LogChannel`). Exports a singleton `notificationService`.\n    - `src/config/notifications.ts`: Exports a `notificationConfig` object containing settings like `emailRecipients`, `webhookUrl`, etc.\n\n2.  **Modified `utils.ts`:**\n    - The function `sendLegacyEmailAlert(to: string, subject: string, body: string): Promise<void>` and any related types have been completely removed.\n\n3.  **Example Module Refactoring (e.g., in `src/module_63.ts`):**\n\n    *   **Before:**\n        ```typescript\n        import { sendLegacyEmailAlert } from '../utils';\n        // ...\n        async function checkBackupIntegrity(backupId: string) {\n          const isCorrupt = await someCheck(backupId);\n          if (isCorrupt) {\n            console.error(`CRITICAL-ALERT: Backup ${backupId} is corrupt!`);\n            await sendLegacyEmailAlert('sysops@pulsesphere.com', 'Corrupt Backup Detected', `Backup with ID ${backupId} failed integrity check.`);\n          }\n        }\n        ```\n\n    *   **After:**\n        ```typescript\n        import { notificationService } from '../services/notificationService';\n        // ...\n        async function checkBackupIntegrity(backupId: string) {\n          const isCorrupt = await someCheck(backupId);\n          if (isCorrupt) {\n            await notificationService.dispatch({\n              severity: 'critical',\n              title: 'Corrupt Backup Detected',\n              sourceModule: 'module_63',\n              details: {\n                backupId: backupId,\n                checkTime: new Date().toISOString(),\n                reason: 'Failed integrity check.'\n              }\n            });\n          }\n        }\n        ```\n\n4.  **All other modules containing alert logic** (e.g., `module_30`, `module_50`, `module_70`) will exhibit similar refactoring patterns, replacing their unique alert calls with a standardized call to `notificationService.dispatch()`.",
  "context_files": [
    "src/module_70.ts",
    "src/module_30.ts",
    "src/module_33.ts",
    "src/module_50.ts",
    "src/utils.ts",
    "name",
    "type",
    "src/module_41.ts",
    "children",
    "src/module_4.ts",
    "src/module_2.ts",
    "src/module_1.ts",
    "src/module_48.ts",
    "src/module_56.ts",
    "src/module_61.ts",
    "src/module_17.ts",
    "src/module_31.ts",
    "src/module_26.ts",
    "src/module_6.ts",
    "src/module_69.ts",
    "src/module_14.ts",
    "src/module_52.ts",
    "src/module_65.ts",
    "src/module_34.ts",
    "src/module_74.ts",
    "src/module_23.ts",
    "src/module_7.ts",
    "src/module_15.ts",
    "src/module_9.ts",
    "src/module_5.ts",
    "src/module_20.ts",
    "src/module_28.ts",
    "src/module_43.ts",
    "src/module_63.ts",
    "src/module_38.ts",
    "src/module_54.ts",
    "src/module_40.ts",
    "src/module_66.ts",
    "src/module_45.ts",
    "src/module_29.ts",
    "src/module_11.ts",
    "src/module_60.ts",
    "src/module_32.ts",
    "src/module_49.ts",
    "src/module_8.ts",
    "src/module_62.ts",
    "src/module_37.ts",
    "src/module_3.ts",
    "src/module_10.ts",
    "src/module_58.ts",
    "src/module_42.ts",
    "src/module_22.ts",
    "src/module_55.ts",
    "src/module_47.ts",
    "src/module_21.ts",
    "src/module_57.ts",
    "src/module_64.ts",
    "src/module_36.ts",
    "src/module_51.ts",
    "src/module_59.ts",
    "src/module_46.ts",
    "src/module_67.ts",
    "src/module_44.ts",
    "src/module_35.ts",
    "src/module_53.ts",
    "src/module_24.ts",
    "src/module_68.ts",
    "src/module_75.ts",
    "src/module_18.ts",
    "src/module_16.ts",
    "src/module_25.ts",
    "src/module_39.ts",
    "src/module_12.ts",
    "src/module_27.ts",
    "src/module_73.ts"
  ],
  "task_category": "cross_file_refactoring",
  "evaluation_criteria": [
    "**Correctness & Compilation:** The final code must compile successfully without any TypeScript errors.",
    "**Completeness of Refactoring:** All instances of legacy alerting (email, webhooks, tagged logs) must be identified and replaced with the new service call.",
    "**Quality of Abstraction:** The new `NotificationService` and `NotificationChannel` interface must be well-designed, extensible, and follow standard object-oriented principles.",
    "**Configuration Centralization:** All hardcoded configuration values (emails, URLs) must be successfully moved to `src/config/notifications.ts` and used by the service.",
    "**Code Removal (Cleanup):** The old `sendLegacyEmailAlert` function in `src/utils.ts` must be successfully removed. No dead code should remain.",
    "**Functional Equivalence:** The refactoring must not alter the core business logic of the modules. The conditions that trigger alerts should remain identical.",
    "**Modularity and Imports:** The agent must correctly manage imports/exports for the new services and update them in all refactored modules."
  ]
}