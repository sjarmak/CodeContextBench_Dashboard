#---------------------------------------------------------------------------
#  Doxyfile for SynestheticCanvas API Suite (api_graphql)
#---------------------------------------------------------------------------
#  This Doxygen configuration is tailored for a high-throughput C microservice
#  constellation that exposes both GraphQL and REST interfaces.  The options
#  are set up to:
#
#    • generate cross-referenced HTML and PDF documentation
#    • embed source-code browsing with syntax highlighting
#    • visualise component interactions via Graphviz / Dot
#    • tag public API symbols, versioning, and deprecation notices
#    • integrate with CI pipelines (warnings as errors, XML export)
#
#  Author(s)  : SynestheticCanvas Core Team
#  Last Edited: 2024-06-06
#---------------------------------------------------------------------------

#---------------------------------------------------------------------------
# Project related configuration options
#---------------------------------------------------------------------------

PROJECT_NAME           = "SynestheticCanvas API Suite (api_graphql)"
PROJECT_NUMBER         = "v2.3.1"
PROJECT_BRIEF          = "Color-coded GraphQL/REST gateway for real-time media blending"
PROJECT_LOGO           = docs/assets/logo_synestheticcanvas.svg

OUTPUT_DIRECTORY       = docs/build
CREATE_SUBDIRS         = YES

#---------------------------------------------------------------------------
# Configuration file inclusion
#---------------------------------------------------------------------------
# Allow stacking configs (global + component + local overrides)
# DOXYFILE_ENCODING UTF-8 is implicit for modern Doxygen; kept for clarity.

DOXYFILE_ENCODING      = UTF-8
@INCLUDE_PATH          = docs/doxygen/includes
# Example: @INCLUDE                = common.doxyinc

#---------------------------------------------------------------------------
# Build related configuration options
#---------------------------------------------------------------------------

EXTRACT_ALL            = YES
EXTRACT_PRIVATE        = NO           # Keep internals private
EXTRACT_STATIC         = NO
EXTRACT_LOCAL_CLASSES  = YES
EXTRACT_ANON_NSPACES   = YES
SOURCE_BROWSER         = YES
INLINE_SOURCES         = YES
REFERENCED_BY_RELATION = YES
REFERENCES_RELATION    = YES
ALPHABETICAL_INDEX     = YES
GENERATE_TREEVIEW      = YES
FULL_PATH_NAMES        = NO
STRIP_FROM_PATH        = "$(PROJECT_SOURCE_ROOT)"
STRIP_FROM_INC_PATH    = "$(PROJECT_SOURCE_ROOT)/include"

#---------------------------------------------------------------------------
# Input
#---------------------------------------------------------------------------

INPUT                  = src include tests
FILE_PATTERNS          = *.c *.h *.graphql *.proto
INPUT_FILTER           =
RECURSIVE              = YES
EXCLUDE                = src/third_party
EXCLUDE_PATTERNS       = */build/* */.git/*

#---------------------------------------------------------------------------
# Output formats
#---------------------------------------------------------------------------

GENERATE_HTML          = YES
HTML_OUTPUT            = html
HTML_DYNAMIC_SECTIONS  = YES
HTML_COLORSTYLE        = DARK

GENERATE_LATEX         = YES
LATEX_OUTPUT           = latex
PDF_HYPERLINKS         = YES
USE_PDFLATEX           = YES
LATEX_BATCHMODE        = NO
COMPACT_LATEX          = NO

GENERATE_XML           = YES   # For CI quality gates (clang-tidy, SonarQube, …)

#---------------------------------------------------------------------------
# Dot / Graphviz visualisation
#---------------------------------------------------------------------------

HAVE_DOT               = YES
DOT_NUM_THREADS        = 4
DOT_IMAGE_FORMAT       = svg
INTERACTIVE_SVG        = YES
CALL_GRAPH             = YES
CALLER_GRAPH           = YES
CLASS_GRAPH            = YES
COLLABORATION_GRAPH    = YES
DOT_MULTI_TARGETS      = YES
DOT_CLEANUP            = YES
GRAPH_ABBREVIATE_PATH  = YES

#---------------------------------------------------------------------------
# Warnings / diagnostics
#---------------------------------------------------------------------------

WARNINGS               = YES
WARN_IF_UNDOCUMENTED   = YES
WARN_IF_DOC_ERROR      = YES
WARN_NO_PARAMDOC       = YES
WARN_AS_ERROR          = YES
QUIET                  = NO
WARN_LOGFILE           = docs/build/doxygen_warnings.log

#---------------------------------------------------------------------------
# Parsing / preprocessing
#---------------------------------------------------------------------------

ENABLE_PREPROCESSING   = YES
MACRO_EXPANSION        = YES
EXPAND_ONLY_PREDEF     = NO
SEARCH_INCLUDES        = YES
INCLUDE_PATH           = include
PREDEFINED             = \
    SC_API_PUBLIC=__attribute__((visibility("default"))) \
    SC_DEPRECATED=__attribute__((deprecated)) \
    SC_BEGIN_DECLS="extern \"C\" {" \
    SC_END_DECLS="}"

#---------------------------------------------------------------------------
# Source code tags & aliases
#---------------------------------------------------------------------------

ALIASES               += "endpoint=\par Endpoint:"
ALIASES               += "stroke=\par Brush-Stroke:"
ALIASES               += "service=\par Service:"
ALIASES               += "todo=\xrefitem todo \"TODO\" \"TODO List\" "

#---------------------------------------------------------------------------
# Version control integration
#---------------------------------------------------------------------------

VCS_NUMBERING          = YES
VCS_BRANCH_PATTERN     = main|v[0-9]+\.[0-9]+(\.[0-9]+)?
GENERATE_TAGFILE       = docs/build/api_graphql.tag

#---------------------------------------------------------------------------
# Miscellaneous
#---------------------------------------------------------------------------

MULTILINE_CPP_IS_BRIEF = YES
TAB_SIZE               = 4
OPTIMIZE_OUTPUT_FOR_C  = YES
MARKDOWN_SUPPORT       = YES
AUTOLINK_SUPPORT       = YES
EXTENSION_MAPPING      = graphql=C
CLANG_ASSISTED_PARSING = NO

#---------------------------------------------------------------------------
# End of Doxyfile
#---------------------------------------------------------------------------