```yaml
################################################################################
# FortiLedger360 Enterprise Security Suite – Production Environment Config
#
# NOTE:
#   • This file is consumed by both the deployment orchestrator (Helm/Kustomize)
#     and the C++ runtime via the cfg::Loader utility.
#   • Do NOT commit plain-text credentials. Everything sensitive must reference
#     HashiCorp Vault or AWS Secrets Manager via the ${…} interpolation syntax.
################################################################################

environment: production
version: 4                       # Semantic bump each time breaking changes land
revision: ${GIT_COMMIT_SHA}      # Injected by CI/CD (GitHub Actions)

###############################################################################
# Global defaults (can be merged using <<: *defaults)
###############################################################################
defaults: &defaults
  replicas: 3
  resources:
    limits:
      cpu: "500m"
      memory: "768Mi"
    requests:
      cpu: "250m"
      memory: "512Mi"
  restartPolicy: Always
  imagePullPolicy: IfNotPresent
  healthChecks:
    liveness:
      path: /health/live
      intervalSeconds: 15
      timeoutSeconds: 5
    readiness:
      path: /health/ready
      intervalSeconds: 10
      timeoutSeconds: 3
  logging:
    level: warn                 # debug | info | warn | error | critical
    format: json
    retentionDays: 14
  tracing:
    enabled: true
    provider: jaeger
    endpoint: "http://jaeger-trace.collector:14268/api/traces"
    samplingRate: 0.05          # 5 % of the traffic

###############################################################################
# Networking & Service Mesh
###############################################################################
network:
  mesh:
    provider: istio
    mTLS:
      enabled: true
      minTLSVersion: TLSv1_3
    sidecarInjection: true
    circuitBreaker:
      maxConnections: 500
      maxPendingRequests: 1000
      sleepWindowMs: 5000
  apiGateway:
    host: "api.prod.fortiledger360.com"
    ingressClass: "alb"         # prod uses AWS ALB w/ WAF
    rateLimits:
      perMinute: 2000
      burst: 400
    cors:
      allowOrigins:
        - "https://console.fortiledger360.com"
        - "https://partner.fortiledger360.com"
      allowMethods: [GET, POST, PUT, DELETE, OPTIONS]
      allowHeaders: ["Content-Type", "Authorization"]
      allowCredentials: true

###############################################################################
# Observability (Prometheus, Grafana, Loki, etc.)
###############################################################################
observability:
  metrics:
    prometheusScrape: true
    retentionDays: 30
  logs:
    aggregator: loki
    retentionDays: 14
    labels:
      environment: production
      team: secops
  alerts:
    provider: pagerduty
    escalationPolicy: "PD12345"
    slaBoundRules:
      criticalLatency:
        expr: histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m])) > 0.75
        for: 5m
        severity: critical
      errorBudget:
        expr: sum(rate(http_request_errors_total[1h])) / sum(rate(http_requests_total[1h])) > 0.005
        for: 15m
        severity: warning

###############################################################################
# Persistent Stores
###############################################################################
datastores:
  postgres:
    clusterEndpoint: "pg-prod.cluster-abcdefg.us-east-1.rds.amazonaws.com"
    port: 5432
    database: "fortiledger"
    username: "forti_app"
    password: "${vault:secret/data/prod/postgres#password}"
    maxPoolSize: 40
    sslMode: require
  redis:
    endpoint: "redis-prod.xzyb12.ng.0001.use1.cache.amazonaws.com"
    port: 6379
    tls: true
    password: "${vault:secret/data/prod/redis#password}"
    poolSize: 30
  objectStorage:
    provider: s3
    bucket: "fortiledger360-prod-artifacts"
    region: "us-east-1"
    credentials:
      accessKeyId: "${vault:secret/data/prod/aws#access_key_id}"
      secretAccessKey: "${vault:secret/data/prod/aws#secret_access_key}"

###############################################################################
# Feature Flags (rollout via LaunchDarkly)
###############################################################################
features:
  load_balancing:           true
  security_scanning:        true
  performance_metrics:      true
  backup_recovery:          true
  configuration_management: true
  progressive_scanning:
    enabled: true
    rolloutPercentage: 25   # Gradually ramp up new diff-only scanner
  ai_incident_triage:
    enabled: false          # Experimental

###############################################################################
# Service Definitions
###############################################################################
services:

  # Presentation Layer
  front_end:
    <<: *defaults
    image: "ghcr.io/fortiledger360/frontend:${version}"
    ports: [8080]
    env:
      API_GATEWAY_URL: "https://api.prod.fortiledger360.com"

  api_gateway:
    <<: *defaults
    replicas: 4
    image: "ghcr.io/fortiledger360/api-gateway:${version}"
    ports: [9000, 9001]     # gRPC & REST
    env:
      JWT_PUBLIC_KEY: "${vault:secret/data/prod/jwt#public}"
      RATE_LIMIT_REDIS: "redis://:${redis.password}@${redis.endpoint}:${redis.port}/0"
    logging:
      level: info

  # Orchestration Layer
  orchestrator:
    <<: *defaults
    image: "ghcr.io/fortiledger360/orchestrator:${version}"
    ports: [9100]
    env:
      EVENT_BUS_URL: "nats://nats-mesh:4222"
      POSTGRES_DSN: "postgres://${datastores.postgres.username}:${datastores.postgres.password}@${datastores.postgres.clusterEndpoint}:${datastores.postgres.port}/${datastores.postgres.database}?sslmode=${datastores.postgres.sslMode}"
      REDIS_URI: "rediss://:${datastores.redis.password}@${datastores.redis.endpoint}:${datastores.redis.port}/1"

  # Domain Services
  scanner_service:
    <<: *defaults
    replicas: 6
    image: "ghcr.io/fortiledger360/scanner:${version}"
    ports: [9200]
    env:
      VULN_DB_ENDPOINT: "https://cve.mitre.org/"
      SCAN_STRATEGY: "continuous"
    resources:
      limits:
        cpu: "1000m"
        memory: "2Gi"
      requests:
        cpu: "500m"
        memory: "1Gi"

  config_manager:
    <<: *defaults
    image: "ghcr.io/fortiledger360/config-manager:${version}"
    ports: [9300]
    env:
      DRIFT_DETECT_SCHEDULE: "0 */2 * * *"    # every 2 hours

  backup_node:
    <<: *defaults
    image: "ghcr.io/fortiledger360/backup-node:${version}"
    ports: [9400]
    env:
      BACKUP_BUCKET: "${datastores.objectStorage.bucket}"
      BACKUP_REGION: "${datastores.objectStorage.region}"
      ACCESS_KEY: "${datastores.objectStorage.credentials.accessKeyId}"
      SECRET_KEY: "${datastores.objectStorage.credentials.secretAccessKey}"
    resources:
      limits:
        cpu: "750m"
        memory: "1.5Gi"
      requests:
        cpu: "500m"
        memory: "1Gi"

  alert_broker:
    <<: *defaults
    image: "ghcr.io/fortiledger360/alert-broker:${version}"
    ports: [9500]
    env:
      PAGERDUTY_ROUTING_KEY: "${observability.alerts.escalationPolicy}"

###############################################################################
# Compliance & Policy Engine
###############################################################################
compliance:
  iso27001:
    enabled: true
    controlSetVersion: 2022
  soc2:
    enabled: true
    trustServicePrinciples:
      - security
      - availability
      - confidentiality
  gdpr:
    enabled: true
    dpaContactEmail: "privacy@fortiledger360.com"
  cis_benchmarks:
    k8s:
      enabled: true
      minScore: 85        # percent
    linux:
      enabled: true
      minScore: 90
  policyPipeline:          # Chain-of-Responsibility order
    - ValidateRequestSchema
    - EnforceRateLimits
    - CheckTenantQuota
    - ApplyComplianceRules
    - ResolveBillingPlan
    - PublishAuditEvent

###############################################################################
# Scheduler & CronJobs
###############################################################################
scheduledJobs:
  prune_old_backups:
    schedule: "0 3 * * *"      # daily at 03:00 UTC
    command: ["/bin/backup-node", "prune", "--older-than", "30d"]
    concurrencyPolicy: Forbid
  refresh_vuln_db:
    schedule: "*/15 * * * *"   # every 15 minutes
    command: ["/bin/scanner", "refreshdb"]
    concurrencyPolicy: Replace
  monthly_invoice_generation:
    schedule: "0 0 1 * *"      # 1st of every month
    command: ["/bin/billing", "generate"]
    concurrencyPolicy: Forbid

###############################################################################
# Security Hardening
###############################################################################
security:
  podSecurityPolicy:
    level: restricted
    allowPrivilegeEscalation: false
    forbidRoot: true
  imageScanning:
    signedImagesOnly: true
    cosignPublicKeys:
      - "https://keys.fortiledger360.com/cosign.pub"
  secretsManagement:
    provider: vault
    mountPath: "/vault/secrets"
    renewalIntervalSeconds: 3600
  jwt:
    issuer: "https://auth.fortiledger360.com"
    audience: ["fortiledger360"]
    algorithms: ["RS256"]
    clockSkewSeconds: 60

###############################################################################
# Disaster Recovery
###############################################################################
dr:
  crossRegionReplication:
    enabled: true
    targetRegion: "us-west-2"
  rtoMinutes: 30               # Recovery Time Objective
  rpoMinutes: 10               # Recovery Point Objective
  backupEncryption:
    kmsKeyId: "arn:aws:kms:us-east-1:123456789012:key/abcd-1234-efgh-5678"
  testSchedule: "0 5 15 * *"   # Fire-drill on the 15th of each month

###############################################################################
# End of file
###############################################################################
```