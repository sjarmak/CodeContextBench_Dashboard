```yaml
# ---------------------------------------------------------------------------------
# FortiLedger360 Enterprise Security Suite â€” Continuous Integration Workflow
#
# This workflow is executed on every push / pull-request to the `main` branch and
# on manual dispatch.  It builds the C++ code-base, executes unit & integration
# tests, runs static-analysis (clang-tidy + cppcheck) and uploads build artifacts
# as well as coverage reports.  A SonarCloud scan is triggered after successful
# builds, and versioned tags automatically generate GitHub releases.
# ---------------------------------------------------------------------------------

name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch: {}

concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true

defaults:
  run:
    shell: bash

env:
  CTEST_OUTPUT_ON_FAILURE: 1
  LC_ALL: C.UTF-8
  LANG: C.UTF-8

jobs:
  # ---------------------------------------------------------
  # Build / Test / Static-Analysis  â€” Matrix across OS & C++
  # ---------------------------------------------------------
  build-test:
    name: Build & Test (${{ matrix.os }} | ${{ matrix.compiler }} | ${{ matrix.build_type }})
    runs-on: ${{ matrix.os }}
    timeout-minutes: 60

    strategy:
      fail-fast: false
      matrix:
        os: [ ubuntu-22.04, macos-13 ]
        compiler: [ gcc-12, clang-16 ]
        build_type: [ Debug, Release ]
        exclude:
          - os: macos-13
            compiler: gcc-12          # GCC is not preinstalled on GitHub macOS images

    env:
      BUILD_TYPE: ${{ matrix.build_type }}
      CMAKE_CXX_COMPILER: ${{ matrix.compiler }}
      CPPCHECK_HTML_REPORT: cppcheck-report

    steps:
      - name: ğŸ›ï¸ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0               # Needed for accurate coverage / sonar reporting

      # --------------------------------------------
      # Dependencies â€” Linux
      # --------------------------------------------
      - name: ğŸ”§ Install dependencies (Linux)
        if: runner.os == 'Linux'
        run: |
          sudo apt-get update
          sudo apt-get install -y --no-install-recommends \
              ninja-build ccache lcov clang-tidy cppcheck doxygen \
              libssl-dev libgrpc++-dev libprotobuf-dev protobuf-compiler-grpc
          echo "/usr/lib/ccache" >> $GITHUB_PATH

      # --------------------------------------------
      # Dependencies â€” macOS
      # --------------------------------------------
      - name: ğŸ”§ Install dependencies (macOS)
        if: runner.os == 'macOS'
        run: |
          brew update
          brew install ninja ccache lcov llvm clang-format cppcheck doxygen \
              grpc openssl protobuf
          echo "/opt/homebrew/opt/ccache/libexec" >> $GITHUB_PATH

      # --------------------------------------------
      # Caching
      # --------------------------------------------
      - name: ğŸ’¾ Cache CMake/Ninja/ccache output
        uses: actions/cache@v3
        with:
          path: |
            ~/.ccache
            build
          key: ${{ runner.os }}-${{ matrix.compiler }}-${{ matrix.build_type }}-${{ hashFiles('**/CMakeLists.txt') }}
          restore-keys: |
            ${{ runner.os }}-${{ matrix.compiler }}-${{ matrix.build_type }}-

      # --------------------------------------------
      # Configure
      # --------------------------------------------
      - name: âš™ï¸ Configure CMake
        run: |
          cmake -S . -B build \
            -G Ninja \
            -DCMAKE_BUILD_TYPE=${BUILD_TYPE} \
            -DCMAKE_C_COMPILER_LAUNCHER=ccache \
            -DCMAKE_CXX_COMPILER_LAUNCHER=ccache \
            -DFORTILEDGER_ENABLE_TESTS=ON \
            -DFORTILEDGER_ENABLE_COVERAGE=$([[ "${BUILD_TYPE}" == "Debug" ]] && echo ON || echo OFF)

      # --------------------------------------------
      # Build
      # --------------------------------------------
      - name: ğŸ—ï¸ Build
        run: cmake --build build --target all --parallel $(nproc || sysctl -n hw.logicalcpu)

      # --------------------------------------------
      # Unit & Integration Tests
      # --------------------------------------------
      - name: âœ… Run tests
        run: |
          ctest --test-dir build \
                --parallel $(nproc || sysctl -n hw.logicalcpu) \
                --output-on-failure

      # --------------------------------------------
      # Coverage (only on Linux / GCC / Debug)
      # --------------------------------------------
      - name: ğŸ“Š Generate coverage report
        if: matrix.os == 'ubuntu-22.04' && matrix.compiler == 'gcc-12' && matrix.build_type == 'Debug'
        run: |
          lcov --directory build --capture --output-file coverage.info
          lcov --remove coverage.info '/usr/*' '*/tests/*' --output-file coverage.info
          lcov --list coverage.info

      - name: ğŸ“¤ Upload coverage artifact
        if: matrix.os == 'ubuntu-22.04' && matrix.compiler == 'gcc-12' && matrix.build_type == 'Debug'
        uses: actions/upload-artifact@v3
        with:
          name: coverage-gcc-debug
          path: coverage.info

      # --------------------------------------------
      # clang-tidy (clang builds only)
      # --------------------------------------------
      - name: ğŸ” clang-tidy analysis
        if: matrix.compiler == 'clang-16'
        run: |
          run-clang-tidy -quiet -p build -j $(nproc || sysctl -n hw.logicalcpu) || true

      # --------------------------------------------
      # cppcheck â€” all builds
      # --------------------------------------------
      - name: ğŸ” cppcheck analysis
        run: |
          cppcheck --enable=all --inconclusive --project=build/compile_commands.json \
                   --output-file=cppcheck.xml --xml \
                   --suppress=missingIncludeSystem \
                   2> cppcheck.log || true
          cppcheck-htmlreport --file=cppcheck.xml --report-dir=${CPPCHECK_HTML_REPORT}

      - name: ğŸ“¤ Upload static analysis
        uses: actions/upload-artifact@v3
        with:
          name: ${{ runner.os }}-${{ matrix.compiler }}-analysis
          path: |
            cppcheck.xml
            cppcheck.log
            ${{ env.CPPCHECK_HTML_REPORT }}

      # --------------------------------------------
      # Packaging
      # --------------------------------------------
      - name: ğŸ“¦ Package artifacts
        run: |
          cmake --build build --target package
          ls -R build | head

      - name: ğŸ“¤ Upload build artifacts
        uses: actions/upload-artifact@v3
        with:
          name: ${{ runner.os }}-${{ matrix.compiler }}-${{ matrix.build_type }}-package
          path: build/*.tar.gz

  # ---------------------------------------------------------
  # SonarCloud â€” Static Application Security Testing (SAST)
  # ---------------------------------------------------------
  sonarcloud:
    name: SonarCloud Scan
    runs-on: ubuntu-22.04
    needs: build-test
    if: >
      github.repository == 'FortiLedger360/EnterpriseSecuritySuite'
      && github.event_name != 'pull_request_target'
    timeout-minutes: 30
    steps:
      - name: ğŸ›ï¸ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ” SonarCloud analysis
        uses: SonarSource/sonarcloud-github-action@master
        with:
          projectBaseDir: .
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          SONAR_SCANNER_OPTS: -Xmx4096m

  # ---------------------------------------------------------
  # Release â€” Triggered on version tags (v*)
  # ---------------------------------------------------------
  release:
    name: Publish Release
    needs: build-test
    runs-on: ubuntu-22.04
    if: startsWith(github.ref, 'refs/tags/v')
    timeout-minutes: 20
    steps:
      - name: ğŸ›ï¸ Checkout
        uses: actions/checkout@v4

      - name: â¬‡ï¸ Download packaged artifacts
        uses: actions/download-artifact@v3
        with:
          path: dist

      - name: ğŸš€ Create GitHub release
        uses: softprops/action-gh-release@v1
        with:
          files: dist/**/*.{tar.gz,zip}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```