{
  "info": {
    "_postman_id": "ebde1234-5678-90ab-cdef-1234567890ab",
    "name": "EduPay Ledger Academy – Public API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Postman collection for the EduPay Ledger Academy fintech payment platform.  \n\nThis collection is intentionally annotated and scripted so instructors can demonstrate real-world topics such as idempotency, multi-currency settlement, HMAC request signing, and the Saga Pattern.  \n\nAll calls assume an API-Key based security model.  Swap the `{{apiKey}}` variable with your issued key and (optionally) replace the `{{hmacSecret}}` if you want to demo custom signing algorithms.\n"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "https://sandbox.edupay.io",
      "type": "string"
    },
    {
      "key": "apiKey",
      "value": "REPLACE_WITH_YOUR_API_KEY",
      "type": "string"
    },
    {
      "key": "hmacSecret",
      "value": "REPLACE_WITH_YOUR_HMAC_SECRET",
      "type": "string"
    },
    {
      "key": "requestId",
      "value": "0",
      "type": "string"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "exec": [
          "// ----- COLLECTION-LEVEL PRE-REQUEST SCRIPT ----------------------------------------",
          "// Generates a globally unique X-Request-Id and an HMAC signature so that each request",
          "// is idempotent and tamper-evident.  Professors can pause execution here to illustrate",
          "// how fintech APIs mitigate replay attacks.\n",
          "const uuid = require('uuid');",
          "",
          "const requestId = uuid.v4();",
          "pm.collectionVariables.set('requestId', requestId);",
          "",
          "// Build the canonical string (method + path + timestamp).",
          "const timestamp = Date.now().toString();",
          "const method    = pm.request ? pm.request.method : '';",
          "const path      = pm.request ? pm.request.url.getPath() : '';",
          "const canonical = `${method}\\n${path}\\n${timestamp}`;",
          "",
          "// Compute HMAC using SHA-256.",
          "const secret  = pm.collectionVariables.get('hmacSecret');",
          "const hash    = CryptoJS.HmacSHA256(canonical, secret);",
          "const signature = CryptoJS.enc.Hex.stringify(hash);",
          "",
          "// Attach headers required by the backend.",
          "pm.request.headers.upsert({ key: 'X-Request-Id', value: requestId });",
          "pm.request.headers.upsert({ key: 'X-Timestamp',  value: timestamp  });",
          "pm.request.headers.upsert({ key: 'X-Signature',  value: signature  });",
          "pm.request.headers.upsert({ key: 'Authorization', value: `ApiKey ${pm.collectionVariables.get('apiKey')}` });"
        ],
        "type": "text/javascript"
      }
    }
  ],
  "item": [
    {
      "name": "Admissions",
      "description": "Endpoints related to on-boarding new students and collecting application fees.",
      "item": [
        {
          "name": "Pay Application Fee",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/admissions/applications/12345/pay-fee",
              "host": ["{{baseUrl}}"],
              "path": ["admissions", "applications", "12345", "pay-fee"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\"      : 50.00,\n  \"currency\"    : \"USD\",\n  \"paymentToken\": \"tok_visa_1Gn...\",\n  \"capture\"     : true\n}"
            },
            "description": "Collects a non-refundable application fee.  Supports both immediate capture and delayed capture flows."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 201', function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test('Response contains paymentId', function () {",
                  "    const json = pm.response.json();",
                  "    pm.expect(json).to.have.property('paymentId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Bursar",
      "description": "Core payment endpoints that bursar’s office interacts with daily.",
      "item": [
        {
          "name": "Initiate Tuition Payment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payments",
              "host": ["{{baseUrl}}"],
              "path": ["payments"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"studentId\"   : \"stu_78910\",\n  \"amount\"      : 27000,\n  \"currency\"    : \"USD\",\n  \"method\"      : \"ACH\",\n  \"description\" : \"Fall 2024 Tuition\",\n  \"metadata\"    : {\n    \"semester\"  : \"Fall 2024\",\n    \"program\"   : \"Computer Science BS\"\n  }\n}"
            },
            "description": "Creates a tuition payment intent. The API returns a `paymentId` which can later be used for capture or refund."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Tuition payment created', function () {",
                  "    pm.expect(pm.response.code).to.equal(202);",
                  "    pm.expect(pm.response.json()).to.have.property('paymentId');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Retrieve Payment",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/payments/{{paymentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["payments", "{{paymentId}}"]
            },
            "description": "Fetches the latest status, including settlement and reconciliation details."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Payment retrieved', function () {",
                  "    pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Refund Payment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/payments/{{paymentId}}/refund",
              "host": ["{{baseUrl}}"],
              "path": ["payments", "{{paymentId}}", "refund"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"amount\"   : 5000,\n  \"reason\"   : \"Course withdrawal before add/drop deadline\",\n  \"metadata\" : {\n    \"operator\" : \"bursar_user_14\"\n  }\n}"
            },
            "description": "Performs a partial or full refund. Distributed tracing is enabled by propagating the `X-Request-Id`."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Refund accepted', function () {",
                  "    pm.expect(pm.response.code).to.equal(202);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Financial-Aid",
      "description": "Disbursement flows for grants, scholarships, and stipends.",
      "item": [
        {
          "name": "Disburse Scholarship",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/financial-aid/disbursements",
              "host": ["{{baseUrl}}"],
              "path": ["financial-aid", "disbursements"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"studentId\"     : \"stu_78910\",\n  \"program\"       : \"STEM Scholars\",\n  \"amount\"        : 3000,\n  \"currency\"      : \"USD\",\n  \"scheduledDate\" : \"2024-08-15\"\n}"
            },
            "description": "Schedules a scholarship disbursement. The actual ACH transfer happens on the scheduled date, respecting cut-off windows."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Disbursement scheduled', function () {",
                  "    pm.expect(pm.response.code).to.equal(201);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Retrieve Disbursement",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/financial-aid/disbursements/{{disbursementId}}",
              "host": ["{{baseUrl}}"],
              "path": ["financial-aid", "disbursements", "{{disbursementId}}"]
            },
            "description": "Obtains real-time status including ACH trace number once available."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Disbursement retrieved', function () {",
                  "    pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Continuing-Education",
      "description": "Typical storefront endpoints for non-degree courses and micro-credentials.",
      "item": [
        {
          "name": "List Courses",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/continuing-education/courses",
              "host": ["{{baseUrl}}"],
              "path": ["continuing-education", "courses"]
            },
            "description": "Public endpoint; no authentication required."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Courses returned', function () {",
                  "    pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Enroll in Course",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/continuing-education/enrollments",
              "host": ["{{baseUrl}}"],
              "path": ["continuing-education", "enrollments"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"studentId\"  : \"stu_231\",\n  \"courseId\"   : \"ce_sql_101\",\n  \"payment\"    : {\n    \"amount\"   : 199,\n    \"currency\" : \"USD\",\n    \"method\"   : \"card\",\n    \"token\"    : \"tok_mastercard_1Hn...\"\n  }\n}"
            },
            "description": "Atomic operation that both enrolls a student and processes the payment."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Enrollment created', function () {",
                  "    pm.expect(pm.response.code).to.equal(201);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Admin & Compliance",
      "description": "Endpoints reserved for compliance officers and DevOps.",
      "item": [
        {
          "name": "Retrieve Audit Log",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/admin/audit/logs?limit=100&cursor=",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "audit", "logs"],
              "query": [
                {
                  "key": "limit",
                  "value": "100"
                },
                {
                  "key": "cursor",
                  "value": ""
                }
              ]
            },
            "description": "Streams immutable audit events. The response is cursor-based to avoid overloading the client."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Audit log fetched', function () {",
                  "    pm.expect(pm.response.code).to.equal(200);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Trigger Saga-Pattern Outage (Demo)",
          "request": {
            "method": "POST",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/admin/simulations/saga/failure",
              "host": ["{{baseUrl}}"],
              "path": ["admin", "simulations", "saga", "failure"]
            },
            "description": "Injects a deterministic failure into the payment service to force a compensating transaction, illustrating the Saga Pattern."
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Simulation accepted', function () {",
                  "    pm.expect(pm.response.code).to.equal(202);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    }
  ]
}