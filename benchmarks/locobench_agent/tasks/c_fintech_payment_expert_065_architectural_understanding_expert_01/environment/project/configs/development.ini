;-------------------------------------------------------------------------------
; EduPay Ledger Academy
; Development Environment Configuration (development.ini)
;
; This INI file is read at application start-up by the bootstrap layer written in
; C (see src/bootstrap/config_loader.c).  All values are exposed to the domain
; layer through the ConfigProvider interface so that professors can hot-swap
; backing services without recompilation.
;
; NOTE:
;   1. Never commit secrets to VCS.  All tokens & passwords below are *dummy*
;      placeholders for classroom use only.
;   2. Use `make sanitize-sample` to strip credentials before publishing.
;-------------------------------------------------------------------------------

###############################################################################
# GLOBAL SETTINGS
###############################################################################
[default]
app_name               = EduPay Ledger Academy
environment            = development
is_debug               = true
enable_hot_reload      = true            ; Auto-recompile shared libs on change
timezone               = UTC
base_currency          = USD
supported_currencies   = USD,EUR,GBP,CAD,JPY
decimal_precision      = 4               ; e.g., 1/10000th of a cent
max_concurrent_workers = 32

###############################################################################
# BUILD / COMPILER FLAGS
###############################################################################
[build]
c_standard             = c18
enable_sanitizers      = address,undefined
warnings_as_errors     = true
optimization_level     = 0               ; O0 for easier debugging
extra_cflags           = -fPIC -Wall -Wextra -Wpedantic
extra_ldflags          = -pthread

###############################################################################
# DATABASE CONFIGURATION PER BOUNDED CONTEXT
###############################################################################
[database.common]
driver                 = postgres
host                   = localhost
port                   = 5432
user                   = edupay_dev
password               = edupay_dev_pw
pool_min               = 2
pool_max               = 16
connection_timeout_ms  = 5000
; schema_migration_tool is executed by `make db-migrate`
schema_migration_tool  = flyway

[database.admissions]
name                   = admissions_dev
schema                 = admissions

[database.bursar]
name                   = bursar_dev
schema                 = bursar

[database.financial_aid]
name                   = fin_aid_dev
schema                 = financial_aid

[database.continuing_education]
name                   = cont_ed_dev
schema                 = continuing_education

###############################################################################
# MESSAGE BROKER (EVENT BUS)
###############################################################################
[message_broker]
engine                 = rabbitmq
host                   = localhost
port                   = 5672
username               = edupay_mq_dev
password               = edupay_mq_pw
virtual_host           = /
prefetch_count         = 50
connection_retry_ms    = 3000
dead_letter_exchange   = edupay.dlx

###############################################################################
# EVENT SOURCING / CQRS
###############################################################################
[event_sourcing]
enabled                = true
event_store_driver     = postgres
event_store_db         = events_dev
snapshot_interval      = 250             ; Create snapshot every 250 events
projection_workers     = 4
outbox_table           = event_outbox

###############################################################################
# SAGA PATTERN / DISTRIBUTED TRANSACTIONS
###############################################################################
[saga]
demo_mode              = true            ; Induce random failures for labs
coordinator_endpoint   = http://localhost:8088
timeout_ms             = 45000
retry_backoff_ms       = 250
max_retries            = 5

###############################################################################
# THIRD-PARTY PAYMENT PROCESSOR (SANDBOX)
###############################################################################
[payment_processor]
provider               = Stripe
api_base_url           = https://api.sandbox.stripe.com
secret_key             = sk_test_1234567890
publishable_key        = pk_test_0987654321
webhook_secret         = whsec_test_abcdef
callback_port          = 9090
enable_idempotency     = true

###############################################################################
# FRAUD DETECTION
###############################################################################
[fraud_detection]
heuristics_profile     = dev_light
threshold_score        = 0.7
enable_device_fingerprinting = true
ip_geolocation_service = https://freegeoip.app/json/
velocity_window_minutes       = 30
max_tx_per_window             = 20

###############################################################################
# REGULATORY COMPLIANCE
###############################################################################
[compliance]
pci_dss_mode           = sandbox
ferpa_redaction        = true
psd2_sca_simulation    = true
data_retention_days    = 30
gdpr_anonymize_after_days = 14

###############################################################################
# LOGGING
###############################################################################
[logging]
level                  = DEBUG
output                 = stdout
file_path              = ./logs/edupay_dev.log
max_file_size_mb       = 50
max_backups            = 5
format                 = %d{ISO8601} [%t] %-5p %c - %m%n
json_logs              = false

###############################################################################
# METRICS & TRACING
###############################################################################
[observability]
metrics_provider       = prometheus
metrics_port           = 9100
tracing_provider       = jaeger
tracing_endpoint       = http://localhost:14268/api/traces
sample_rate            = 1.0

###############################################################################
# CACHING
###############################################################################
[cache]
engine                 = redis
host                   = localhost
port                   = 6379
db                     = 0
ttl_seconds            = 900
enable_ssl             = false

###############################################################################
# SECURITY
###############################################################################
[security]
jwt_secret             = CHANGE_ME_DEV_ONLY
jwt_expiration_minutes = 120
password_hash_algo     = argon2id
tls_certificate_path   = ./certs/dev/server.crt
tls_key_path           = ./certs/dev/server.key
csrf_protection        = true
allowed_origins        = http://localhost:3000, http://127.0.0.1:3000

###############################################################################
# FEATURE TOGGLES
###############################################################################
[feature_toggle]
enable_multi_currency          = true
enable_real_time_dashboard     = true
enable_micro_credential_tokens = true
enable_audit_trail_export      = true
enable_student_sandbox_wallet  = true

###############################################################################
# EMAIL (FOR DEMO NOTIFICATIONS)
###############################################################################
[email]
smtp_server            = localhost
smtp_port              = 1025
username               = ""
password               = ""
from_address           = no-reply@edupay.dev
enable_tls             = false

###############################################################################
# SANDBOX USER ACCOUNTS (AUTO-PROVISIONED)
###############################################################################
[sandbox_users]
admin_email            = admin@edupay.dev
admin_password         = admin123
student_email          = student@edupay.dev
student_password       = student123

###############################################################################
# END OF FILE
###############################################################################