{
  "ground_truth": "The solution is a set of changes across multiple files that correctly uses the established architectural patterns.\n\n1.  **`configs/default_settings.json`**: Added `\"focus_mode_enabled\": false`.\n2.  **`flockdesk/core/ipc/event_types.py`**: Added a new event type like `FOCUS_MODE_CHANGED = 'system/focus_mode_changed'`.\n3.  **`flockdesk/core/shortcuts/commands.py`**: A new class `ToggleFocusModeCommand` is implemented. Its `execute` method gets the `SettingsService` and `EventBus` (likely via a service locator or singleton pattern), toggles the setting, and publishes the `FOCUS_MODE_CHANGED` event with the new boolean state.\n4.  **`flockdesk/core/shell/menu_bar.py`**: A new `QAction` for 'Toggle Focus Mode' is created and connected to an instance of `ToggleFocusModeCommand`.\n5.  **`flockdesk/modules/chat/viewmodel/chat_vm.py`**: The ViewModel's `__init__` subscribes to `FOCUS_MODE_CHANGED`. A handler method updates a new property (e.g., `self.is_snoozed`). The logic for suppressing notifications would also be tied to this property.\n6.  **`flockdesk/modules/dashboard/viewmodel/dashboard_vm.py`**: The ViewModel's `__init__` subscribes to `FOCUS_MODE_CHANGED`. A handler method updates a new property (e.g., `self.activity_feed_opacity`).\n7.  **`flockdesk/modules/dashboard/view/dashboard_widget.py`**: The widget's styling logic for the activity feed is connected to the new ViewModel property, dynamically changing its appearance.",
  "context_files": [
    "flockdesk/core/main.py",
    "flockdesk/core/app.py",
    "flockdesk/modules/chat/main.py",
    "flockdesk/modules/whiteboard/main.py",
    "flockdesk/modules/co_editor/main.py",
    "flockdesk/modules/presence/main.py",
    "flockdesk/modules/dashboard/main.py",
    "docs/api/index.rst",
    "configs/default_settings.json",
    "flockdesk/modules/dashboard/service.py",
    "flockdesk/modules/chat/service.py",
    "flockdesk/modules/whiteboard/service.py",
    "flockdesk/modules/presence/service.py",
    "flockdesk/modules/co_editor/service.py",
    "flockdesk/modules/whiteboard/model/canvas_state.py",
    "tests/unit/modules/test_whiteboard_model.py",
    "flockdesk/modules/presence/viewmodel/presence_vm.py",
    "flockdesk/core/services/settings_service.py",
    "flockdesk/modules/whiteboard/viewmodel/whiteboard_vm.py",
    "flockdesk/modules/dashboard/viewmodel/dashboard_vm.py",
    "flockdesk/core/services/crash_reporter.py",
    "flockdesk/modules/chat/model/conversation.py",
    "flockdesk/core/services/auth_service.py",
    "flockdesk/core/services/update_service.py",
    "flockdesk/modules/presence/view/presence_widget.py",
    "flockdesk/modules/whiteboard/view/whiteboard_widget.py",
    "flockdesk/core/services/process_manager.py",
    "flockdesk/core/services/profile_service.py",
    "flockdesk/modules/co_editor/viewmodel/editor_vm.py",
    "tests/unit/modules/test_chat_vm.py",
    "flockdesk/modules/co_editor/model/document.py",
    "flockdesk/modules/chat/viewmodel/chat_vm.py",
    "flockdesk/modules/dashboard/view/dashboard_widget.py",
    "flockdesk/modules/chat/view/chat_widget.py",
    "flockdesk/modules/co_editor/view/editor_widget.py",
    "flockdesk/modules/chat/view/chat_widget.ui",
    "flockdesk/modules/presence/model/user_status.py",
    "tests/unit/core/test_settings_service.py",
    "docs/architecture.md",
    "flockdesk/core/shell/menu_bar.py",
    "flockdesk/core/shortcuts/shortcut_manager.py",
    "tests/conftest.py",
    "flockdesk/shared/mvvm/view_base.py",
    "flockdesk/core/plugins/plugin_manager.py",
    "flockdesk/core/theming/theme_manager.py",
    "scripts/run_dev.sh",
    "flockdesk/shared/utils/singleton.py",
    "tests/unit/core/test_layout_manager.py",
    "assets/icons/app_icon.png",
    "flockdesk/shared/mvvm/viewmodel_base.py",
    "flockdesk/shared/ipc/event_client.py",
    "plugins_available/poll_plugin/poll.py",
    "flockdesk/core/ipc/event_types.py",
    "scripts/build.py",
    "flockdesk/core/shortcuts/commands.py",
    "tests/integration/test_profile_sync.py",
    "flockdesk/shared/widgets/avatar_widget.py",
    "flockdesk/core/shell/layout_manager.py",
    "flockdesk/core/shell/status_bar.py",
    "plugins_available/code_review_plugin/review_widget.py",
    "plugins_available/code_review_plugin/review_panel.py",
    "flockdesk/core/ipc/event_bus.py",
    "tests/integration/test_event_bus_communication.py",
    "flockdesk/core/plugins/plugin_manifest.py",
    "flockdesk/core/shell/main_window.py",
    "flockdesk/shared/schemas/user_profile.py",
    "tests/integration/test_plugin_loading.py",
    "flockdesk/shared/schemas/events.py",
    "plugins_available/poll_plugin/poll_widget.py",
    "docs/guides/03_plugin_development.md",
    "assets/fonts/Inter-Regular.ttf",
    "tests/unit/core/test_plugin_manager.py",
    "flockdesk/core/theming/themes/light_theme.qss"
  ],
  "task_category": "architectural_understanding",
  "evaluation_criteria": [
    "**Architectural Adherence (Event Bus):** Did the agent correctly use the `EventBus` for broadcasting the state change, or did it attempt to create direct, tightly-coupled calls between UI components and modules?",
    "**Architectural Adherence (Service Layer):** Was the `SettingsService` correctly identified and used as the single source of truth for the persistent 'Focus Mode' state?",
    "**Architectural Adherence (MVVM):** Were the changes in the modules correctly implemented within the ViewModel layer, with the View layer being a passive observer of the ViewModel's state?",
    "**Component Discovery:** Did the agent successfully locate and modify the correct, disparate set of files required for the task (settings config, event types, menu bar, command definitions, and multiple module ViewModels)?",
    "**Code Modularity:** Is the new code well-integrated without breaking existing patterns? Is the `ToggleFocusModeCommand` self-contained and reusable?",
    "**Completeness:** Does the final implementation satisfy all functional requirements: persistence, a working toggle, and the specified UI changes in both the Chat and Dashboard modules?"
  ]
}