{
  // ---------------------------------------------------------------------------
  //  MosaicBoard Studio - Application Configuration Template
  //  Rename to `app_config.json` and replace ${...} placeholders with real
  //  values or environment-variable substitutions resolved by your build
  //  pipeline (e.g. CMake configure_file, Docker-compose, Kubernetes secrets).
  //
  //  NOTE: This is a JSONC (JSON with comments) template. Strip comments if
  //  your deployment target only supports strict JSON.
  // ---------------------------------------------------------------------------

  "general": {
    "app_name"            : "MosaicBoard Studio",
    "environment"         : "${ENVIRONMENT}",          // e.g. development / staging / production
    "version"             : "1.0.0",
    "instance_id"         : "${HOSTNAME}",             // Used for clustering / metrics
    "default_locale"      : "en-US",
    "timezone"            : "UTC"
  },

  "server": {
    "host"                : "0.0.0.0",
    "port"                : 8443,
    "threads"             : 8,                         // Worker threads for the HTTP pool
    "graceful_timeout_ms" : 10000,
    "ssl": {
      "enabled"           : true,
      "certificate_path"  : "/etc/ssl/certs/mosaicboard.pem",
      "private_key_path"  : "/etc/ssl/private/mosaicboard.key",
      "client_auth"       : "none"                     // none / optional / required
    }
  },

  "logging": {
    "level"               : "info",                    // trace / debug / info / warn / error / fatal
    "file_path"           : "/var/log/mosaicboard/mosaicboard.log",
    "rotation": {
      "size_mb"           : 20,
      "files"             : 10,
      "flush_interval_ms" : 500
    },
    "structured"          : true                       // Enable JSON-structured logs
  },

  "database": {
    "type"                : "postgresql",
    "host"                : "${DB_HOST}",
    "port"                : 5432,
    "name"                : "${DB_NAME}",
    "username"            : "${DB_USER}",
    "password"            : "${DB_PASSWORD}",
    "pool_size"           : 15,
    "connection_timeout_s": 5,
    "ssl_mode"            : "require"                  // disable / allow / prefer / require
  },

  "cache": {
    "enabled"             : true,
    "provider"            : "redis",
    "redis": {
      "host"              : "${REDIS_HOST}",
      "port"              : 6379,
      "db"                : 0,
      "password"          : "${REDIS_PASSWORD}",
      "ssl"               : false,
      "connection_timeout_ms": 200,
      "reconnect_attempts": 5
    },
    "default_ttl_s"       : 300
  },

  "authentication": {
    "jwt_secret"          : "${JWT_SECRET}",
    "token_expiry_minutes": 60,
    "password_hash_algo"  : "argon2id",
    "oauth_providers": {
      "google": {
        "client_id"       : "${GOOGLE_CLIENT_ID}",
        "client_secret"   : "${GOOGLE_CLIENT_SECRET}",
        "redirect_uri"    : "${BASE_URL}/auth/google/callback",
        "scopes"          : [ "email", "profile" ]
      },
      "github": {
        "client_id"       : "${GITHUB_CLIENT_ID}",
        "client_secret"   : "${GITHUB_CLIENT_SECRET}",
        "redirect_uri"    : "${BASE_URL}/auth/github/callback",
        "scopes"          : [ "read:user", "user:email" ]
      }
    },
    "session_cookie": {
      "name"              : "mbs_session",
      "secure"            : true,
      "http_only"         : true,
      "same_site"         : "Lax"
    }
  },

  "payment": {
    "provider"            : "stripe",
    "currency"            : "USD",
    "sandbox_mode"        : true,
    "stripe": {
      "api_key"           : "${STRIPE_API_KEY}",
      "webhook_secret"    : "${STRIPE_WEBHOOK_SECRET}",
      "retry_attempts"    : 3
    }
  },

  "api": {
    "base_path"           : "/api/v1",
    "rate_limit_per_minute": 120,
    "cors": {
      "allowed_origins"   : [ "*" ],                  // Replace * with trusted origins in prod
      "allowed_methods"   : [ "GET", "POST", "PUT", "DELETE", "OPTIONS" ],
      "allowed_headers"   : [ "Authorization", "Content-Type" ],
      "exposed_headers"   : [ "X-Request-ID" ],
      "max_age_s"         : 600
    }
  },

  "event_bus": {
    "backend"             : "nats",                   // nats / rabbitmq / kafka / inproc
    "nats": {
      "url"               : "${NATS_URL}",
      "max_reconnects"    : 10,
      "reconnect_wait_ms" : 2000,
      "tls_enabled"       : false
    },
    "buffer_size"         : 1024                      // Internal ring-buffer size per channel
  },

  "plugins": {
    "directory"           : "/opt/mosaicboard/plugins",
    "autoload"            : true,
    "watchdog_interval_ms": 3000,                     // Hot-reload poll interval
    "whitelist"           : [                         // Empty list -> allow all
      // "libdata_heatmap.so",
      // "libwaveform_visualizer.so"
    ]
  },

  "uploads": {
    "temp_dir"            : "/tmp/mbs_uploads",
    "max_file_size_mb"    : 250,
    "allowed_mime_types"  : [
      "image/png",
      "image/jpeg",
      "video/mp4",
      "application/pdf",
      "text/csv"
    ],
    "clean_interval_minutes" : 60
  },

  "email": {
    "provider"            : "smtp",
    "smtp": {
      "host"              : "${SMTP_HOST}",
      "port"              : 587,
      "username"          : "${SMTP_USER}",
      "password"          : "${SMTP_PASSWORD}",
      "use_tls"           : true,
      "from_address"      : "no-reply@mosaicboard.io"
    }
  },

  "security": {
    "allowed_hosts"       : [ "mosaicboard.io", "api.mosaicboard.io" ],
    "csrf_cookie_secure"  : true,
    "hsts_enabled"        : true,
    "content_security_policy": "default-src 'self'; img-src * data:; media-src *",
    "x_frame_options"     : "DENY"
  },

  "metrics": {
    "enabled"             : true,
    "endpoint"            : "/metrics",
    "provider"            : "prometheus",
    "collect_interval_s"  : 15
  },

  "feature_flags": {
    "enable_experimental_tiles": false,
    "enable_live_collaboration": false
  }
}