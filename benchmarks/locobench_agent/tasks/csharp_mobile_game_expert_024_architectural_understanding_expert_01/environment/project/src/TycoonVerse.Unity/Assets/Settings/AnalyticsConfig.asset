```csharp
// File: TycoonVerse/src/TycoonVerse.Unity/Assets/Settings/AnalyticsConfig.asset
// NOTE: Although this file sits under *.asset in the repository tree, it is a
//       ScriptableObject that Unity serializes into an .asset at edit-time.
//       Keep the filename as-is so Unity can resolve the reference.

using System;
using System.Collections.Generic;
using System.Linq;
using UnityEngine;

namespace TycoonVerse.Settings
{
    /// <summary>
    /// Centralised configuration for analytics, A/B testing and telemetry
    /// across TycoonVerse.  Stored as a ScriptableObject so designers can
    /// tweak values in the Inspector without touching code.
    ///
    /// The asset is loaded at runtime through <see cref="Instance"/> and lives
    /// under a Resources folder to support addressable-less bootstrap.
    /// </summary>
    [CreateAssetMenu(
        fileName = "AnalyticsConfig",
        menuName = "TycoonVerse/Settings/Analytics Config",
        order = 0)]
    public sealed class AnalyticsConfig : ScriptableObject, ISerializationCallbackReceiver
    {
        #region Singleton Loader ------------------------------------------------

        private static AnalyticsConfig _instance;

        /// <summary>
        /// Lazy-loads the configuration from Resources. Falls back on a
        /// hard-coded default if the asset is missing so the game can still boot
        /// in developer builds.
        /// </summary>
        public static AnalyticsConfig Instance
        {
            get
            {
                if (_instance != null) return _instance;

                _instance = Resources.Load<AnalyticsConfig>("Settings/AnalyticsConfig");

#if UNITY_EDITOR
                // In the editor we try a direct asset database lookup so the
                // file does not have to live under Resources during dev.
                if (_instance == null)
                {
                    var assets = UnityEditor.AssetDatabase.FindAssets("t:AnalyticsConfig");
                    if (assets.Length > 0)
                    {
                        var path = UnityEditor.AssetDatabase.GUIDToAssetPath(assets[0]);
                        _instance = UnityEditor.AssetDatabase.LoadAssetAtPath<AnalyticsConfig>(path);
                    }
                }
#endif

                // Final fallback so the game never null-refs.
                if (_instance == null)
                {
                    Debug.LogWarning(
                        "[AnalyticsConfig] No asset found; using default in-memory config.");
                    _instance = CreateInstance<AnalyticsConfig>();
                    _instance.ApplyDefaultValues();
                }

                return _instance;
            }
        }

        #endregion ----------------------------------------------------------------

        #region Editor-Facing Fields ---------------------------------------------

        [Header("General")]
        [SerializeField] private BuildEnvironment _environment = BuildEnvironment.Production;
        [SerializeField] private bool _enableAnalytics = true;
        [SerializeField] private bool _enableCrashReporting = true;
        [SerializeField] private string _appVersionOverride = string.Empty; // leave blank to use Application.version

        [Header("Providers")]
        [SerializeField] private ProviderSettings _unityAnalytics = new ProviderSettings
        {
            Name = "Unity Analytics",
            ApiKey = string.Empty,
            EndpointUrl = "https://analytics.cloud.unity3d.com"
        };

        [SerializeField] private ProviderSettings _firebase = new ProviderSettings
        {
            Name = "Firebase",
            ApiKey = string.Empty,
            EndpointUrl = "https://app-measurement.com"
        };

        [Header("Sampling Rates")]
        [Tooltip("Percentage threshold between 0-100. 100 means send every event.")]
        [SerializeField] private SerializableDictionary<string, float> _eventSamplingRate =
            new SerializableDictionary<string, float>()
            {
                { "default", 100f },
                { "iap_success", 100f },
                { "iap_failure", 100f },
                { "session_start", 100f },
                { "factory_scan", 50f } // upload events are expensive
            };

        [Header("A/B Tests")]
        [SerializeField] private List<AbTestSettings> _experiments =
            new List<AbTestSettings>
            {
                new AbTestSettings
                {
                    ExperimentId = "main_menu_layout",
                    Variants = new[] { "classic", "material" },
                    TrafficAllocation = new[] { 50, 50 }
                }
            };

        #endregion ----------------------------------------------------------------

        #region Public Properties -------------------------------------------------

        public BuildEnvironment Environment => _environment;
        public bool EnableAnalytics => _enableAnalytics;
        public bool EnableCrashReporting => _enableCrashReporting;
        public string AppVersion =>
            string.IsNullOrWhiteSpace(_appVersionOverride)
                ? Application.version
                : _appVersionOverride;

        public IReadOnlyDictionary<string, float> EventSamplingRate => _eventSamplingRate;
        public IEnumerable<AbTestSettings> Experiments => _experiments;

        public ProviderSettings UnityAnalytics => _unityAnalytics;
        public ProviderSettings Firebase => _firebase;

        #endregion ----------------------------------------------------------------

        #region Runtime API -------------------------------------------------------

        /// <summary>
        /// Determines if the given event should be sent, taking sampling and
        /// global enable flag into account.
        /// </summary>
        public bool ShouldSendEvent(string eventName, System.Random prng = null)
        {
            if (!_enableAnalytics) return false;

            prng ??= UnityEngine.Random.state.GetHashCode() == 0
                ? new System.Random()
                : new System.Random(UnityEngine.Random.state.GetHashCode());

            var key = _eventSamplingRate.ContainsKey(eventName) ? eventName : "default";
            var threshold = _eventSamplingRate[key].Clamp(0, 100);
            var roll = prng.NextDouble() * 100d;

            return roll <= threshold;
        }

        /// <summary>
        /// Returns the variant that the user falls into for the provided
        /// experiment, using a stable hash so the bucket remains sticky.
        /// </summary>
        public string GetVariant(string experimentId, string userId)
        {
            var experiment = _experiments.FirstOrDefault(e =>
                string.Equals(e.ExperimentId, experimentId, StringComparison.Ordinal));

            if (experiment == null || experiment.Variants.Length == 0)
                return "control";

            var hash = Math.Abs(userId.GetStableHashCode()) % 100; // 0-99
            var cumulative = 0;

            for (var i = 0; i < experiment.Variants.Length; i++)
            {
                cumulative += Mathf.Clamp(experiment.TrafficAllocation[i], 0, 100);
                if (hash < cumulative) return experiment.Variants[i];
            }

            return experiment.Variants[0]; // Fallback
        }

        #endregion ----------------------------------------------------------------

        #region Validation & Defaults --------------------------------------------

        private void ApplyDefaultValues()
        {
            _enableAnalytics = true;
            _enableCrashReporting = true;
            _environment = BuildEnvironment.Development;
        }

        private void OnValidate()
        {
            // Ensure that traffic allocation adds up to <= 100
            foreach (var exp in _experiments)
            {
                var total = exp.TrafficAllocation.Sum();
                if (total > 100)
                {
                    Debug.LogWarning(
                        $"[AnalyticsConfig] Experiment '{exp.ExperimentId}' traffic " +
                        $"allocation exceeds 100% (currently {total}%).");
                }
            }
        }

        #endregion ----------------------------------------------------------------

        #region ISerializationCallbackReceiver -----------------------------------

        public void OnBeforeSerialize()
        {
            // Nothing to do.
        }

        public void OnAfterDeserialize()
        {
            // Trim empty keys (Unity serialises empty dictionary keys as null).
            var emptyKeys = _eventSamplingRate
                .Where(kvp => string.IsNullOrWhiteSpace(kvp.Key))
                .Select(kvp => kvp.Key)
                .ToList();

            foreach (var key in emptyKeys)
                _eventSamplingRate.Remove(key);
        }

        #endregion ----------------------------------------------------------------
    }

    // ---------------------------------------------------------------------------

    public enum BuildEnvironment
    {
        Development,
        Staging,
        Production
    }

    // ---------------------------------------------------------------------------

    /// <summary>
    /// Configuration for an analytics or crash-reporting provider.
    /// </summary>
    [Serializable]
    public sealed class ProviderSettings
    {
        public string Name;
        public string ApiKey;
        public string EndpointUrl;
        public bool Enabled => !string.IsNullOrWhiteSpace(ApiKey);
    }

    // ---------------------------------------------------------------------------

    /// <summary>
    /// Simple container for A/B experiment metadata.
    /// </summary>
    [Serializable]
    public sealed class AbTestSettings
    {
        public string ExperimentId;
        public string[] Variants = Array.Empty<string>();

        [Tooltip("Allocation per variant, must line up with Variants array.")]
        public int[] TrafficAllocation = Array.Empty<int>();
    }

    // ---------------------------------------------------------------------------
    // Helpers
    // ---------------------------------------------------------------------------

    /// <summary>
    /// SerializableDictionary shim because Unity's default Dictionary is not
    /// serialisable in the Inspector. This implementation is minimal but
    /// sufficient for configuration.
    /// </summary>
    [Serializable]
    public sealed class SerializableDictionary<TKey, TValue> :
        Dictionary<TKey, TValue>,
        ISerializationCallbackReceiver
    {
        [SerializeField] private List<TKey> _keys = new List<TKey>();
        [SerializeField] private List<TValue> _values = new List<TValue>();

        public void OnBeforeSerialize()
        {
            _keys.Clear();
            _values.Clear();

            foreach (var kvp in this)
            {
                _keys.Add(kvp.Key);
                _values.Add(kvp.Value);
            }
        }

        public void OnAfterDeserialize()
        {
            Clear();

            var count = Math.Min(_keys.Count, _values.Count);
            for (var i = 0; i < count; i++)
            {
                // Avoid duplicate keys which will throw.
                if (ContainsKey(_keys[i])) continue;
                this[_keys[i]] = _values[i];
            }
        }
    }

    internal static class NumericExtensions
    {
        public static float Clamp(this float value, float min, float max) =>
            value < min ? min : (value > max ? max : value);
    }

    internal static class HashExtensions
    {
        // Fowler–Noll–Vo hash for stable user bucketing.
        public static int GetStableHashCode(this string str)
        {
            unchecked
            {
                const int offsetBasis = unchecked((int)2166136261);
                const int prime = 16777619;

                var hash = offsetBasis;
                foreach (var c in str ?? string.Empty)
                {
                    hash ^= c;
                    hash *= prime;
                }

                return hash;
            }
        }
    }
}
```