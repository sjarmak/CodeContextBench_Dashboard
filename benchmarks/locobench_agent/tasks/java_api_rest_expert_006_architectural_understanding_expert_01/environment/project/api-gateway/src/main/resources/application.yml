```yaml
####################################################################################################
#  OpsForge Utility Nexus – API Gateway                                                             #
#  application.yml                                                                                 #
#                                                                                                  #
#  This configuration bootstraps the Spring Boot–powered API Gateway that fronts all utility       #
#  micro-services.  It wires in route definitions, resiliency, observability, version negotiation, #
#  response-caching, GraphQL exposure, and pagination defaults—while remaining 100 % environment   #
#  agnostic through the heavy use of overrides & placeholders.                                     #
####################################################################################################

spring:
  application:
    name: opsforge-utility-nexus-api-gateway

  profiles:
    # The active profile is expected to be supplied via JVM argument or environment variable:
    # ‑ Dspring.profiles.active=prod  OR  SPRING_PROFILES_ACTIVE=prod
    active: ${SPRING_PROFILES_ACTIVE:local}

  cloud:
    discovery:
      enabled: true                                   # Leverages Spring Cloud discovery client (e.g. Netflix Eureka, Consul, K8s API)
    gateway:
      httpclient:
        connect-timeout: 5000                         # Global timeouts (ms) for non-blocking WebClient
        response-timeout: 10s

      default-filters:
        # ‑- Global, ordered filter chain (applies to every route) ‑-
        - name: RequestRateLimiter                    # Backed by Redis via Spring Data Redis
          args:
            redis-rate-limiter.replenishRate: ${RATE_LIMIT_REPLENISH_RATE:20}
            redis-rate-limiter.burstCapacity: ${RATE_LIMIT_BURST_CAP:40}
            redis-rate-limiter.requestedTokens: 1
        - name: CacheResponse
          args:
            ttl: 60s                                  # Response-cache TTL
            statusCodes: "200,201,204"
        - name: RewriteResponseHeader
          args:
            regexp: "'Server', '.*'"
            replacement: "'Server','OpsForge-Gateway/${project.version}'"

      routes:
        # ------------------------------------------------------------------------------------------
        # File-Converter Micro-service
        # ------------------------------------------------------------------------------------------
        - id: file-converter-service
          uri: lb://FILE-CONVERTER-SERVICE            # Logical service ID registered with discovery
          predicates:
            - Path=/v*/files/**                       # Version-prefixed REST paths
          filters:
            - StripPrefix=1
            - CircuitBreaker=name=fileConverterCB
        # ------------------------------------------------------------------------------------------
        # Data Anonymizer Micro-service
        # ------------------------------------------------------------------------------------------
        - id: anonymizer-service
          uri: lb://ANONYMIZER-SERVICE
          predicates:
            - Path=/v*/anonymize/**
          filters:
            - StripPrefix=1
            - CircuitBreaker=name=anonymizerCB
        # ------------------------------------------------------------------------------------------
        # Time-Zone-Aware Scheduler Micro-service
        # ------------------------------------------------------------------------------------------
        - id: scheduler-service
          uri: lb://SCHEDULER-SERVICE
          predicates:
            - Path=/v*/schedules/**
          filters:
            - StripPrefix=1
            - CircuitBreaker=name=schedulerCB
        # ------------------------------------------------------------------------------------------
        # Checksum Generator Micro-service
        # ------------------------------------------------------------------------------------------
        - id: checksum-service
          uri: lb://CHECKSUM-SERVICE
          predicates:
            - Path=/v*/checksums/**
          filters:
            - StripPrefix=1
            - CircuitBreaker=name=checksumCB
        # ------------------------------------------------------------------------------------------
        # Bulk Text Transformer Micro-service
        # ------------------------------------------------------------------------------------------
        - id: text-transform-service
          uri: lb://TEXT-TRANSFORM-SERVICE
          predicates:
            - Path=/v*/transform/**
          filters:
            - StripPrefix=1
            - CircuitBreaker=name=textTransformCB

  graphql:
    servlet:
      mapping: /graphql
      enabled: true
      exception-handlers-enabled: true
    voyager:
      enabled: false
    playground:
      enabled: ${GRAPHQL_PLAYGROUND: false}

# --------------------------------------------------------------------------------------------------
#  Pagination Defaults ‑ Used by reusable paging utilities across controllers / GraphQL resolvers
# --------------------------------------------------------------------------------------------------
pagination:
  default-page-size: 50
  max-page-size: 500

# --------------------------------------------------------------------------------------------------
#  API Versioning Strategy
#  Supported strategies: header | path | media-type
#  The gateway inspects incoming requests and forwards the effective version to downstream services.
# --------------------------------------------------------------------------------------------------
versioning:
  strategy: header
  header-name: X-API-Version
  default-version: v1

# --------------------------------------------------------------------------------------------------
#  Cross-Service Resilience (Resilience4j)
# --------------------------------------------------------------------------------------------------
resilience4j:
  circuitbreaker:
    configs:
      default:
        registerHealthIndicator: true
        slidingWindowSize: 100
        minimumNumberOfCalls: 10
        failureRateThreshold: 50
        slowCallDurationThreshold: 2s
        waitDurationInOpenState: 30s
  timelimiter:
    configs:
      default:
        timeoutDuration: 5s

# --------------------------------------------------------------------------------------------------
#  Response-Caching  (Caffeine, in-memory by default; switch to Redis by profile override)
# --------------------------------------------------------------------------------------------------
cache:
  type: caffeine
  caffeine:
    spec: expireAfterWrite=60s,maximumSize=1000,recordStats

# --------------------------------------------------------------------------------------------------
#  Logging  &  Observability
# --------------------------------------------------------------------------------------------------
logging:
  pattern:
    level: "%5p [${spring.application.name},%X{traceId:-},%X{spanId:-}]"
  level:
    root: INFO
    org.springframework.cloud.gateway: INFO
    com.opsforge: DEBUG

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus,env,cloudwatch
  metrics:
    tags:
      application: ${spring.application.name}
  prometheus:
    metrics:
      export:
        enabled: true

# --------------------------------------------------------------------------------------------------
#  Server Port & Compression
# --------------------------------------------------------------------------------------------------
server:
  port: ${GATEWAY_HTTP_PORT:8080}
  compression:
    enabled: true
    min-response-size: 1024
    mime-types: application/json,application/graphql

# --------------------------------------------------------------------------------------------------
#  Redis Configuration (optional ‑ required for distributed rate-limiter & cache)
# --------------------------------------------------------------------------------------------------
redis:
  host: ${REDIS_HOST:localhost}
  port: ${REDIS_PORT:6379}
  password: ${REDIS_PASSWORD:}

####################################################################################################
#  End of application.yml                                                                          #
####################################################################################################
```