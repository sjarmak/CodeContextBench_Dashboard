```yaml
# =============================================================================
#  OpsForge Utility Nexus – Spring Cloud Config Server
#  ----------------------------------------------------------------------------
#  Central configuration service for all Utility Nexus micro-services.
#  Provides:
#    • Git-backed, version-controlled configuration
#    • Profile & label awareness (dev / staging / prod, main / tags)
#    • Property‐level encryption / decryption
#    • Actuator & Prometheus metrics
#    • OAuth2-based endpoint protection
# =============================================================================

# ----------------------------------------------------------------------------- 
#  Common (default) configuration – applies to every active profile
# -----------------------------------------------------------------------------
server:
  port: 8888                       # Dedicated Config-Server port

spring:
  application:
    name: opsforge-config-server   # Service ID registered with discovery
  main:
    banner-mode: "log"             # Log banner to file, suppress console noise
  jackson:
    default-property-inclusion: non_null

  # Act as a Config Server
  cloud:
    config:
      allow-override: true         # Let downstream apps override shared props
      server:
        # Primary back-end is Git. See profile-specific overrides below.
        git:
          uri: https://github.com/opsforge/utility-nexus-config-repo.git
          default-label: main
          search-paths: '{application}/{profile}'
          clone-on-start: true
          force-pull: true
          timeout: 10
          username: ${GIT_USERNAME:}
          password: ${GIT_PASSWORD:}
        encryption:
          enabled: true            # Allow /encrypt & /decrypt endpoints

  # Toggle which profile block to read (git, vault, or native)
  profiles:
    active: git

# ----------------------------------------------------------------------------- 
#  Encryption settings – symmetric key or JKS. Prefer JKS in production.
# -----------------------------------------------------------------------------
encrypt:
  key: ${CONFIG_SERVER_ENCRYPT_KEY:changeit}   # Fallback for local dev
  key-store:
    location: classpath:config-server-keystore.jks
    alias: config-server-enc
    secret: ${KEYSTORE_SECRET:changeit}

# ----------------------------------------------------------------------------- 
#  Actuator & Metrics
# -----------------------------------------------------------------------------
management:
  server:
    port: 8889                                # Separate mgmt port (optional)
  endpoints:
    web:
      exposure:
        include:
          - health
          - info
          - env
          - refresh
          - metrics
          - prometheus
          - configprops
  endpoint:
    health:
      probes:
        enabled: true
      show-details: when_authorized
  metrics:
    tags:
      application: ${spring.application.name}
    export:
      prometheus:
        enabled: true

# ----------------------------------------------------------------------------- 
#  Logging
# -----------------------------------------------------------------------------
logging:
  file:
    name: ${LOG_DIR:/var/log}/opsforge-config-server.log
  level:
    root: INFO
    org.springframework.cloud.config: DEBUG
    com.opsforge: DEBUG

# ----------------------------------------------------------------------------- 
#  OAuth2 Resource Server (JWT) – protects /actuator & /encrypt endpoints
# -----------------------------------------------------------------------------
spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: https://auth.opsforge.com/oauth2/default
          jwk-set-uri: https://auth.opsforge.com/oauth2/default/v1/keys

# ----------------------------------------------------------------------------- 
#  CORS – Allow utility micro-services running in Kubernetes to hit this server
# -----------------------------------------------------------------------------
cors:
  allowed-origins: 'https://*.opsforge.svc.cluster.local,https://*.opsforge.io'
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: '*'
  allow-credentials: true

# =============================================================================
#  Profile-Specific Overrides
# =============================================================================

# ----------------------------------------------------------------------------- 
#  1. Git profile (default) – Store config in Git
# -----------------------------------------------------------------------------
---
spring:
  profiles: git

  cloud:
    config:
      server:
        git:
          uri: https://github.com/opsforge/utility-nexus-config-repo.git
          default-label: main
          search-paths: '{application}/{profile}'
          clone-on-start: true
          force-pull: true
          timeout: 10
          username: ${GIT_USERNAME}
          password: ${GIT_PASSWORD}

# ----------------------------------------------------------------------------- 
#  2. Vault profile – Store config in HashiCorp Vault (kv-v2)
# -----------------------------------------------------------------------------
---
spring:
  profiles: vault

  cloud:
    config:
      server:
        vault:
          host: vault.opsforge.com
          port: 8200
          scheme: https
          kvVersion: 2
          backend: secret
          profile-separator: '/'
          token: ${VAULT_TOKEN}

  cloud:
    vault:
      uri: https://vault.opsforge.com
      token: ${VAULT_TOKEN}
      kv:
        enabled: true
        backend: secret
        default-context: application

# ----------------------------------------------------------------------------- 
#  3. Native profile – Fallback to local filesystem when offline
# -----------------------------------------------------------------------------
---
spring:
  profiles: native

  cloud:
    config:
      server:
        native:
          search-locations: file:${user.home}/opsforge-configs/{application}

```