[package]
name = "ccs_consensus"
version = "0.1.0"
edition = "2021"
authors = ["CanvasChain Dev Team <dev@canvaschain.io>"]
license = "Apache-2.0"
description = "Consensus microservice for CanvasChain Symphony implementing the Proof-of-Inspiration algorithm."
homepage = "https://canvaschain.io"
repository = "https://github.com/canvaschain/symphony"
readme = "README.md"
keywords = ["blockchain", "nft", "consensus", "p2p", "rust"]
categories = ["cryptography", "network-programming", "async"]
rust-version = "1.70"

[lib]
name = "ccs_consensus"
path = "src/lib.rs"
crate-type = ["lib"]

[[bin]]
name = "ccs-consensusd"
path = "src/bin/ccs-consensusd.rs"

[dependencies]
# --- Async runtime & Concurrency ---
tokio            = { version = "1.35", features = ["full"] }
futures          = "0.3"
async-trait      = "0.1"
parking_lot      = "0.12"
crossbeam        = "0.8"
dashmap          = "5.5"

# --- Networking & RPC ---
tonic            = { version = "0.10", features = ["tls", "transport"] }
prost            = "0.12"
prost-types      = "0.12"
# Event bus integration (optional)
nats             = { version = "0.24", optional = true }

# --- Crypto / VRF / Signature back-ends (pluggable via feature gates) ---
rand             = "0.8"
sha2             = "0.10"
blake3           = "1.5"
ed25519-dalek    = { version = "1.0", features = ["pkcs8"], optional = true }
blst             = { version = "0.3", default-features = false, optional = true }
pqcrypto-kyber   = { version = "0.7", optional = true }
vrf              = { version = "0.8", optional = true }

# --- Observability ---
log              = "0.4"
env_logger       = "0.10"
tracing          = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter", "registry"] }
metrics          = "0.21"
opentelemetry    = { version = "0.20", optional = true }

# --- Serialization ---
serde            = { version = "1.0", features = ["derive"] }
serde_json       = "1.0"

# --- Error handling ---
anyhow           = "1.0"
thiserror        = "1.0"

# --- Feature flags specific to CanvasChain Symphony ---
wallet_integration  = []
governance          = []
token_management    = []
defi_protocols      = []
smart_contracts     = []

[features]
default      = ["ed25519", "event-bus"]
# Pluggable signature curves
ed25519      = ["dep:ed25519-dalek"]
bls          = ["dep:blst"]
pqcrypto     = ["dep:pqcrypto-kyber"]
# Optional subsystems
event-bus    = ["dep:nats"]
telemetry    = ["dep:opentelemetry"]
# Experimental VRF implementation for PoI leader selection
enable-vrf   = ["dep:vrf"]
# CanvasChain specific toggles (inherited by higher-level crates)
wallet_integration  = []
governance          = []
token_management    = []
defi_protocols      = []
smart_contracts     = []

[dev-dependencies]
tokio-test   = "0.4"
criterion    = { version = "0.5", features = ["async"] }
proptest     = "1.4"
assert_matches = "1.5"

[build-dependencies]
tonic-build  = "0.10"
prost-build  = "0.12"

[profile.release]
lto           = true
codegen-units = 1
panic         = "abort"

[badges]
maintenance = { status = "actively-developed" }

[package.metadata.docs.rs]
all-features = true