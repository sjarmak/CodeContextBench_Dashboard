# CanvasChain Symphony – Development Environment Configuration
# File: rust_blockchain_nft_expert_071/config/development.toml
# ------------------------------------------------------------------------------
# This TOML file centralizes configuration for **all** local micro-services when
# running `cargo run --profile=dev` or `docker compose -f dev.yml up`.
#
#  • Designed for rapid iteration, hot-reloading and verbose logging.
#  • Keep private keys DERIVED FROM THESE SEEDS OUT OF PRODUCTION!
#  • All ports are mapped to the host for easy inspection with tools like
#    `grpcurl`, `nats-cli`, `psql`, `redis-cli`, etc.
# ------------------------------------------------------------------------------

################################################################################
# Global section
################################################################################
[env]
environment      = "development"
chain_id         = "canvaschain-devnet"
data_dir         = "./.canvas-data"
log_level        = "debug"           # trace | debug | info | warn | error
metrics_endpoint = "127.0.0.1:9090"  # Prometheus scrape target
event_bus_url    = "nats://127.0.0.1:4222"

# ------------------------------------------------------------------------------
# Feature flags allow selective compilation and runtime toggling
# ------------------------------------------------------------------------------
[features]
wallet_integration = true
governance         = true
token_management   = true
defi_protocols     = true
smart_contracts    = true

################################################################################
# Cryptography & Consensus
################################################################################
[crypto]
# Switchable Strategy Pattern for cryptographic curves
default_curve = "ed25519"           # ed25519 | bls12_381 | falcon512 | dilithium2
# VRF settings for Proof-of-Inspiration consensus
[crypto.vrf]
provider     = "openssl"            # openssl | ring | parity
max_gas_cost = 2_500_000

# Minimum stake (in $CAV) required to become a “composer node”
[consensus]
minimum_stake            = 1_000
round_time_seconds       = 30
fallback_poet_difficulty = "easy"    # easy | standard | high

################################################################################
# Network definitions
################################################################################
[network]
# Multi-address for libp2p cluster
p2p_address = "/ip4/0.0.0.0/tcp/7001"
# Public RPC exposed to DApps
rpc_http    = "127.0.0.1:8545"
rpc_ws      = "127.0.0.1:8546"

################################################################################
# Database connectivity
################################################################################
[database]
# Main ledger state (PostgreSQL)
url               = "postgres://canvas:canvas@localhost:5432/canvas_dev"
max_connections   = 20
connection_timeout_secs = 5

# Off-chain key-value cache (Redis)
[database.cache]
url               = "redis://127.0.0.1:6379"
ttl_seconds       = 600

################################################################################
# Micro-services
################################################################################
# Every service inherits from [service.defaults] and can override as needed
[service.defaults]
grpc_host     = "127.0.0.1"
grpc_retry_ms = 300
grpc_timeout_ms = 5_000
log_format    = "pretty"            # pretty | json
hot_reload    = true

# ------------------------------------------------------------------------------
# Composition Service – orchestrates generative art logic
# ------------------------------------------------------------------------------
[service.composition]
grpc_port         = 50051
enabled           = true
generative_seed   = "canvas-dev-seed"      # DO NOT USE IN PRODUCTION
max_layer_depth   = 16

# ------------------------------------------------------------------------------
# Minting Service – mints multi-layer NFTs on-chain
# ------------------------------------------------------------------------------
[service.minting]
grpc_port         = 50052
enabled           = true
ipfs_gateway      = "http://127.0.0.1:8080"
gas_limit         = 6_000_000

# ------------------------------------------------------------------------------
# Remixing Service – allows community to fork and evolve NFTs
# ------------------------------------------------------------------------------
[service.remixing]
grpc_port         = 50053
enabled           = true
allow_nsfw        = false
default_license   = "CC-BY-SA-4.0"

# ------------------------------------------------------------------------------
# Marketplace Service – primary and secondary sales
# ------------------------------------------------------------------------------
[service.marketplace]
grpc_port         = 50054
enabled           = true
royalty_enforced  = true
marketplace_fee_bps = 250                # 2.5%

# ------------------------------------------------------------------------------
# Royalty Streaming Service – continuous payment flows
# ------------------------------------------------------------------------------
[service.royalty_streaming]
grpc_port         = 50055
enabled           = true
stream_engine     = "superfluid"

# ------------------------------------------------------------------------------
# Governance Service – on-chain voting, proposals, parameter tweaks
# ------------------------------------------------------------------------------
[service.governance]
grpc_port         = 50056
enabled           = true
voting_period_secs  = 86_400             # 24 hours
quorum_percentage   = 15
penalty_burn_bps    = 50

# ------------------------------------------------------------------------------
# DeFi Service – staking, LP, yield farming
# ------------------------------------------------------------------------------
[service.defi]
grpc_port         = 50057
enabled           = true
reward_token      = "CAV"
emission_rate_per_block = "12.5 CAV"

# ------------------------------------------------------------------------------
# Wallet Service – user authentication & signing
# ------------------------------------------------------------------------------
[service.wallet]
grpc_port         = 50058
enabled           = true
jwt_secret        = "local-dev-wallet-secret"
session_ttl_secs  = 7_200

# ------------------------------------------------------------------------------
# Smart Contracts Service – factory & proxy deployment
# ------------------------------------------------------------------------------
[service.smart_contracts]
grpc_port         = 50059
enabled           = true
solc_version      = "0.8.23"
deployer_private_key = "0xfeedfacecafebeefdeadbeef0123456789abcdef0123456789abcdef01234567"

################################################################################
# Third-party integrations
################################################################################
[integrations.ipfs]
api_url       = "http://127.0.0.1:5001"
pinning       = false

[integrations.s3]
enabled       = false
endpoint      = "http://localhost:9000"
access_key    = "minioadmin"
secret_key    = "minioadmin"
bucket        = "canvas-dev"

################################################################################
# Telemetry & Observability
################################################################################
[telemetry]
jaeger_collector    = "http://127.0.0.1:14268/api/traces"
enable_tracing      = true
sampling_rate       = 1.0          # 0.0 … 1.0

################################################################################
# Alerting thresholds – used by observability micro-service
################################################################################
[alerts]
cpu_usage_pct_warn      = 75
cpu_usage_pct_critical  = 90
memory_usage_pct_warn   = 70
memory_usage_pct_critical = 90
disk_free_pct_warn      = 20
disk_free_pct_critical  = 10

################################################################################
# Developer convenience
################################################################################
[dev]
openapi_auto_rebuild    = true
auto_migrate_database   = true
seed_demo_data          = true

# ------------------------------------------------------------------------------
# End of development.toml
# ------------------------------------------------------------------------------