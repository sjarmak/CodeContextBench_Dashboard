```csharp
// --------------------------------------------------------------------------------------------------------------------
// <copyright>
//   PulseOps Warehouse — Serverless Productivity Intelligence Fabric
//   © 2023–{DateTime.UtcNow.Year} PulseOps Inc. All rights reserved.
// </copyright>
// <author>PulseOps Engineering</author>
// <summary>
//   Centralised definition of constants shared across the PulseOps Warehouse code-base.
//   This file intentionally lives outside any specific Lambda project to avoid circular
//   package dependencies; it is imported as a SourceInclude during build.
// </summary>
// --------------------------------------------------------------------------------------------------------------------
#nullable enable
using System;
using System.Collections.Generic;

namespace PulseOps.Warehouse.Shared
{
    /// <summary>
    ///     Defines application-wide constants, categorised in nested static classes for readability.
    ///     All environment variable names, AWS resource identifiers, KPI metric names, and tag keys
    ///     should be consolidated here to guarantee referential consistency.
    /// </summary>
    public static class PulseOpsConstants
    {
        // ---------------------------------------------------------------------------------------------
        // ► Environment Variable Keys
        // ---------------------------------------------------------------------------------------------
        public static class Env
        {
            public const string AwsRegion                = "AWS_REGION";
            public const string Stage                    = "PULSEOPS_STAGE";             // dev | staging | prod
            public const string KinesisIngestStream      = "PULSEOPS_KINESIS_STREAM";
            public const string S3DataLakeBucket         = "PULSEOPS_DATALAKE_BUCKET";
            public const string DynamoTenantTable        = "PULSEOPS_TENANT_TABLE";
            public const string DynamoEventsTable        = "PULSEOPS_EVENTS_TABLE";
            public const string AppConfigApplication     = "PULSEOPS_APPCONFIG_APPLICATION";
            public const string AppConfigEnvironment     = "PULSEOPS_APPCONFIG_ENVIRONMENT";
            public const string AppConfigConfigProfile   = "PULSEOPS_APPCONFIG_PROFILE";
            public const string PagerDutyRoutingKey      = "PULSEOPS_PAGERDUTY_ROUTING_KEY";
            public const string CorrelationId            = "AWS_LAMBDA_FUNCTION_CORRELATION_ID"; // injected via Middy middleware
        }

        // ---------------------------------------------------------------------------------------------
        // ► AWS Resource Names (Logical/Physical)
        // ---------------------------------------------------------------------------------------------
        public static class Resources
        {
            public const string IngestKinesisStream      = "pulseops-stream-ingest";
            public const string EventsParquetGlueJob     = "pulseops-glue-job-events-parquet";
            public const string TenantMetadataTable      = "pulseops-tenant-metadata";
            public const string EventsTable              = "pulseops-events";
            public const string DataLakeBucket           = "pulseops-data-lake";
            public const string DeadLetterQueue          = "pulseops-dlq";
            public const string ObservabilityLogGroup    = "/aws/lambda/pulseops-observability";
        }

        // ---------------------------------------------------------------------------------------------
        // ► Metric Dimensions & Names (CloudWatch/QuickSight)
        // ---------------------------------------------------------------------------------------------
        public static class Metrics
        {
            public const string NamespaceBase            = "PulseOps/Warehouse";
            public const string DimensionTenantId        = "TenantId";
            public const string DimensionStage           = "Stage";

            public static class Names
            {
                public const string EventProcessingLatencyMs = "EventProcessingLatencyMs";
                public const string PipelineSuccessCount     = "PipelineSuccessCount";
                public const string PipelineFailureCount     = "PipelineFailureCount";
                public const string FocusTimeRatio           = "FocusTimeRatio";
                public const string DeploymentLeadTimeMin    = "DeploymentLeadTimeMin";
            }
        }

        // ---------------------------------------------------------------------------------------------
        // ► Application Tagging Keys (applied by IaC to all resources)
        // ---------------------------------------------------------------------------------------------
        public static class Tags
        {
            public const string Project          = "pulseops-warehouse";
            public const string Owner            = "pulseops-devx";
            public const string CostCenter       = "cc-productivity-insights";
            public const string Compliance       = "pci-dss:na";
            public const string DataSensitivity  = "pii:low";
        }

        // ---------------------------------------------------------------------------------------------
        // ► Miscellaneous Constants
        // ---------------------------------------------------------------------------------------------
        public static class Misc
        {
            public const int    DefaultTimeoutSeconds     = 30;
            public const string DateTimeFormatIso8601     = "yyyy-MM-dd'T'HH:mm:ss.fff'Z'";
            public const string SystemUser                = "pulseops-system@pulseops.io";
        }

        // ---------------------------------------------------------------------------------------------
        // ► Helper Utilities
        // ---------------------------------------------------------------------------------------------

        /// <summary>
        ///     Reads an environment variable and throws a <see cref="InvalidOperationException"/>
        ///     if the variable is not set or is empty. Intended to centralise defensive checks.
        /// </summary>
        /// <param name="key">Name of the environment variable to resolve.</param>
        /// <returns>Resolved environment variable value.</returns>
        /// <exception cref="InvalidOperationException">
        ///     Thrown when the environment variable is missing or empty.
        /// </exception>
        public static string RequireEnv(string key)
        {
            var value = Environment.GetEnvironmentVariable(key);
            if (string.IsNullOrWhiteSpace(value))
            {
                throw new InvalidOperationException($"Required environment variable '{key}' is missing or empty.");
            }

            return value;
        }

        /// <summary>
        ///     Convenience overload that returns <paramref name="fallback"/> when the variable
        ///     is not set, avoiding an exception for non-critical defaults.
        /// </summary>
        public static string GetEnv(string key, string fallback) =>
            string.IsNullOrWhiteSpace(Environment.GetEnvironmentVariable(key))
                ? fallback
                : Environment.GetEnvironmentVariable(key)!;

        /// <summary>
        ///     Converts the stage (dev|staging|prod) string into a strongly-typed enum.
        ///     Defensive by design: an unrecognised stage will raise an exception early.
        /// </summary>
        public static DeploymentStage GetDeploymentStage()
        {
            var stage = RequireEnv(Env.Stage).ToLowerInvariant();
            return stage switch
            {
                "dev"     => DeploymentStage.Dev,
                "staging" => DeploymentStage.Staging,
                "prod"    => DeploymentStage.Prod,
                _ => throw new InvalidOperationException(
                    $"Unsupported deployment stage '{stage}'. Expected 'dev', 'staging', or 'prod'.")
            };
        }

        /// <summary>
        ///     Typed representation of the PulseOps deployment stage.
        /// </summary>
        public enum DeploymentStage
        {
            Dev,
            Staging,
            Prod
        }

        /// <summary>
        ///     Safely validates production invariants—invoked by Lambda entry-points during cold start.
        ///     Throws immediately if a critical misconfiguration is detected, halting execution and
        ///     surfacing the error in the logs rather than letting execution continue in an undefined
        ///     state that could corrupt data downstream.
        /// </summary>
        public static void ValidateCriticalEnv()
        {
            var missingVars = new List<string>();

            // List of variables that MUST be present in every runtime.
            var required = new[]
            {
                Env.Stage,
                Env.KinesisIngestStream,
                Env.S3DataLakeBucket,
                Env.DynamoEventsTable,
            };

            foreach (var key in required)
            {
                if (string.IsNullOrWhiteSpace(Environment.GetEnvironmentVariable(key)))
                {
                    missingVars.Add(key);
                }
            }

            if (missingVars.Count > 0)
            {
                throw new InvalidOperationException(
                    $"Critical environment variables were not configured: {string.Join(", ", missingVars)}");
            }
        }
    }
}
```