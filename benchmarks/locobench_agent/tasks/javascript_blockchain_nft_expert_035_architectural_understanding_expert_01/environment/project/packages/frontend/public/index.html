```html
<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src 'self' https:;
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https:;
        style-src  'self' 'unsafe-inline' https:;
        img-src    'self' data: https:;
        connect-src 'self' wss: https:;
        font-src   'self' https: data:;
        frame-ancestors 'none';
        base-uri 'self';
        form-action 'self';
      "
    />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />

    <!-- Preload critical assets -->
    <link rel="preload" href="/fonts/Inter-VariableFont_slnt,wght.ttf" as="font" crossorigin />

    <title>StellarStage Carnival üé™</title>
    <noscript>You need JavaScript enabled to run this app.</noscript>

    <!-- Global styles -->
    <style>
      @font-face {
        font-family: 'Inter var';
        src: url('/fonts/Inter-VariableFont_slnt,wght.ttf') format('truetype');
        font-weight: 100 900;
        font-display: swap;
      }

      html,
      body,
      #root {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden;
        font-family: 'Inter var', sans-serif;
        background: var(--surface-0, #0d0d0d);
        color: var(--text-0, #f5f5f5);
      }

      /* Tiny latency badge (bottom-left) */
      #net-latency {
        position: fixed;
        bottom: 0.75rem;
        left: 0.75rem;
        padding: 0.25rem 0.5rem;
        background: rgba(0, 0, 0, 0.75);
        color: #fff;
        font-size: 11px;
        border-radius: 4px;
        font-variant-numeric: tabular-nums;
        z-index: 2147483647;
        user-select: none;
        pointer-events: none;
        opacity: 0;
        transition: opacity 200ms ease;
      }
      #net-latency.visible {
        opacity: 1;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <div id="net-latency">‚Äì ms</div>

    <script type="module">
      /**
       * index.html bootstrapper
       *
       * 1. Dynamically fetches runtime configuration generated by the backend
       * 2. Registers a Service Worker (in production)
       * 3. Measures initial WebSocket latency to the event bus
       * 4. Hydrates the React / Three.js application
       * 5. Exposes a minimal "window.StellarStage" debugging namespace
       */

      /* ---------- 1. Runtime Config ---------------------------------------------------- */
      /**
       * Fetches /_/config.json which is generated on container boot and contains
       * chain IDs, RPC URLs, GraphQL endpoints, etc.  The file is intentionally
       * served from the same origin to bypass CORS preflights and is cached via
       * `Cache-Control: max-age=60, stale-while-revalidate=300`.
       */
      async function fetchRuntimeConfig() {
        const res = await fetch('/_/config.json', { cache: 'no-store' });
        if (!res.ok) {
          throw new Error('Failed to load runtime configuration');
        }
        return res.json();
      }

      /* ---------- 2. Optional Service Worker ------------------------------------------ */
      async function registerServiceWorker() {
        if (import.meta.env.MODE === 'production' && 'serviceWorker' in navigator) {
          try {
            const { registerSW } = await import('/sw-register.js');
            await registerSW();
          } catch (err) {
            console.error('[SW] Registration failed:', err);
          }
        }
      }

      /* ---------- 3. Latency Probe ----------------------------------------------------- */
      /**
       * Establishes a short-lived WebSocket connection to the event bus in order
       * to calculate round-trip latency.  This information is displayed in
       * bottom-left corner and later shared with the app via `window.__NET_INFO`.
       */
      async function measureLatency(wsUrl) {
        const LATENCY_TIMEOUT = 10_000; // ms
        return new Promise((resolve, reject) => {
          const started = performance.now();
          const socket = new WebSocket(wsUrl);
          const timer = setTimeout(() => {
            socket.close();
            reject(new Error('Latency probe timed out'));
          }, LATENCY_TIMEOUT);

          socket.addEventListener('open', () => {
            socket.send('ping');
          });

          socket.addEventListener('message', () => {
            const ms = Math.round(performance.now() - started);
            clearTimeout(timer);
            socket.close();
            resolve(ms);
          });

          socket.addEventListener('error', reject);
        });
      }

      /* ---------- 4. React / Three.js Hydration --------------------------------------- */
      async function bootApp(runtimeConfig) {
        // Expose config early for external tools
        window.StellarStage = { config: runtimeConfig };

        // Dynamically import the actual React root (code-split for faster first paint)
        const { createRoot } = await import('https://cdn.skypack.dev/react-dom@18/client?dts');
        const React = await import('https://cdn.skypack.dev/react@18?dts');
        const { App } = await import('/src/App.tsx');

        const rootEl = document.getElementById('root');
        const root = createRoot(rootEl);
        root.render(React.createElement(App, { runtimeConfig }));
      }

      /* ---------- 5. Main Flow --------------------------------------------------------- */
      (async () => {
        try {
          const runtimeConfig = await fetchRuntimeConfig();

          // Kick off SW in background (non-blocking)
          registerServiceWorker().catch(console.warn);

          // Parallel latency probe
          const latencyPromise = measureLatency(runtimeConfig.eventBus.wss);

          // Boot the application
          await bootApp(runtimeConfig);

          // Update net-latency badge when probe settles
          latencyPromise
            .then((ms) => {
              window.__NET_INFO = { latency: ms };
              const badge = document.getElementById('net-latency');
              badge.textContent = `${ms} ms`;
              badge.classList.add('visible');
              if (ms > 250) badge.style.background = 'rgba(255, 85, 0, 0.75)';
              if (ms > 600) badge.style.background = 'rgba(255, 0, 0, 0.85)';
            })
            .catch((err) => console.warn('[Net] Latency probe failed:', err));
        } catch (err) {
          const root = document.getElementById('root');
          root.innerHTML =
            '<pre style="color:#f55;white-space:pre-wrap">‚ö†Ô∏è Boot error:\n' +
            (err?.stack || err?.message || err) +
            '</pre>';
          console.error('[Bootstrap] Fatal error:', err);
        }
      })();
    </script>
  </body>
</html>
```