<Project Sdk="Microsoft.NET.Sdk.Web">

  <!--──────────────────────────────────────────────────────────────────────────────
      PaletteStream.Orchestrator
      Description : Central orchestrator service that schedules & coordinates
                    batch and streaming pipelines for PaletteStream ETL Canvas.
      Author      : PaletteStream Engineering
      Copyright   : © PaletteStream Inc. ALL RIGHTS RESERVED.
  ───────────────────────────────────────────────────────────────────────────────-->

  <PropertyGroup>
    <!-- Target latest LTS (.NET 8) for performance and long-term support -->
    <TargetFramework>net8.0</TargetFramework>

    <!-- Enable nullable reference types and implicit global usings -->
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>

    <!-- Use the latest available language features -->
    <LangVersion>latest</LangVersion>

    <!-- Treat all warnings as errors to enforce code quality -->
    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>
    
    <!-- Generate deterministic builds for reproducibility -->
    <ContinuousIntegrationBuild>true</ContinuousIntegrationBuild>

    <!-- Publish settings -->
    <PublishTrimmed>true</PublishTrimmed>
    <PublishSingleFile>false</PublishSingleFile>
    <InvariantGlobalization>true</InvariantGlobalization>
  </PropertyGroup>

  <!--────────────────────────────── Package Dependencies ─────────────────────────-->
  <ItemGroup>
    <!-- Logging & Observability -->
    <PackageReference Include="Serilog.AspNetCore"            Version="7.0.0" />
    <PackageReference Include="Serilog.Sinks.Console"         Version="5.0.1" />
    <PackageReference Include="Serilog.Sinks.Async"           Version="1.5.0" />
    <PackageReference Include="OpenTelemetry.Exporter.OpenTelemetryProtocol" Version="1.8.2" />
    <PackageReference Include="OpenTelemetry.Extensions.Hosting" Version="1.8.2" />

    <!-- Messaging / Streaming -->
    <PackageReference Include="Confluent.Kafka"               Version="2.4.0" />
    <PackageReference Include="MassTransit"                   Version="8.1.8" />
    <PackageReference Include="MassTransit.Kafka"             Version="8.1.8" />

    <!-- Background Job Orchestration -->
    <PackageReference Include="Hangfire.Core"                 Version="1.7.36" />
    <PackageReference Include="Hangfire.AspNetCore"           Version="1.7.36" />

    <!-- Resilience & Policies -->
    <PackageReference Include="Polly"                         Version="7.2.4" />

    <!-- Data Quality / Validation -->
    <PackageReference Include="FluentValidation"              Version="11.7.0" />

    <!-- Diagnostics & Metrics -->
    <PackageReference Include="Prometheus.AspNetCore"         Version="7.0.0" />

    <!-- Analysis / Analyzers -->
    <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="3.3.2" PrivateAssets="all" />
    <PackageReference Include="StyleCop.Analyzers"            Version="1.2.0-beta.435" PrivateAssets="all" />
  </ItemGroup>

  <!--───────────────────────────── Project Dependencies ──────────────────────────-->
  <ItemGroup>
    <!-- Internal shared libraries -->
    <ProjectReference Include="..\..\Shared\PaletteStream.Common\PaletteStream.Common.csproj" />
    <ProjectReference Include="..\..\Shared\PaletteStream.Models\PaletteStream.Models.csproj" />
  </ItemGroup>

  <!--───────────────────────────── Build Configurations ──────────────────────────-->
  <PropertyGroup Condition="'$(Configuration)' == 'Debug'">
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <Optimize>false</Optimize>
  </PropertyGroup>

  <PropertyGroup Condition="'$(Configuration)' == 'Release'">
    <DefineConstants>RELEASE;TRACE</DefineConstants>
    <Optimize>true</Optimize>
    <DebugSymbols>false</DebugSymbols>
  </PropertyGroup>

  <!--───────────────────────────── Test Infrastructure ───────────────────────────-->
  <ItemGroup Condition="'$(IsTestProject)' == 'true'">
    <PackageReference Include="xunit"                        Version="2.5.0" />
    <PackageReference Include="xunit.runner.visualstudio"    Version="2.5.0" />
    <PackageReference Include="Microsoft.NET.Test.Sdk"       Version="17.8.0" />
    <PackageReference Include="FluentAssertions"             Version="6.12.0" />
  </ItemGroup>

  <!--──────────────────────────────────────────────────────────────────────────────-->
</Project>