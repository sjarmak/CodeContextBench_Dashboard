{
  "$schema": "https://json.schemastore.org/appsettings.json",
  "Environment": "Test",
  "Service": {
    "Name": "PaletteStream.Transformer",
    "Version": "1.0.0-test",
    "InstanceId": "test-${HOSTNAME}"
  },

  "AllowedHosts": "*",

  "Logging": {
    "IncludeScopes": false,
    "LogLevel": {
      "Default": "Information",
      "Microsoft": "Warning",
      "Microsoft.Hosting.Lifetime": "Information",
      "System": "Warning"
    },
    "OpenTelemetry": {
      "Endpoint": "http://otel-collector:4317",
      "ExportTraces": true,
      "ExportMetrics": true,
      "SamplingRatio": 1.0
    }
  },

  "Kafka": {
    "BootstrapServers": "kafka:9092",
    "Consumer": {
      "GroupId": "palette-transformer-test",
      "AutoOffsetReset": "Earliest",
      "EnableAutoCommit": false,
      "Topics": [
        "palettestream.raw.test"
      ],
      "ErrorTopic": "palettestream.deadletter.test",
      "EnablePartitionEof": true,
      "StatisticsIntervalMs": 10000
    },
    "Producer": {
      "EnableIdempotence": true,
      "Acks": "All",
      "CompressionType": "gzip",
      "LingerMs": 20,
      "DeliveryTimeoutMs": 30000
    }
  },

  "Hangfire": {
    "Storage": {
      "Type": "PostgreSql",
      "ConnectionString": "Host=postgres;Port=5432;Database=palettestream_jobs_test;Username=job_user;Password=SuperSecret1!"
    },
    "Queues": [
      "default",
      "critical"
    ],
    "WorkerCount": 2
  },

  "DataLake": {
    "ConnectionString": "UseDevelopmentStorage=true;",
    "Zones": {
      "Raw": "azelake/raw/test",
      "Refined": "azelake/refined/test",
      "Curated": "azelake/curated/test"
    }
  },

  "Cache": {
    "RedisConnectionString": "redis:6379,abortConnect=false,ssl=false",
    "DefaultTtlSeconds": 1200
  },

  "StrategyOptions": {
    "Default": "Aggregation",
    "AvailableStrategies": [
      "Aggregation",
      "Enrichment",
      "Anonymization",
      "ColorGrading"
    ]
  },

  "Observer": {
    "EventBus": {
      "Type": "RabbitMQ",
      "Host": "rabbitmq",
      "Port": 5672,
      "Username": "guest",
      "Password": "guest",
      "VirtualHost": "/"
    },
    "Topic": "palettestream.events.test"
  },

  "QualityChecks": {
    "SchemaRegistryUrl": "http://schema-registry:8081",
    "MaxNullPercentage": 0.05,
    "OutlierDetection": {
      "Enabled": true,
      "StandardDeviationThreshold": 3
    }
  },

  "ErrorRecovery": {
    "DeadLetterQueue": "palettestream.deadletter.test",
    "RetryPolicy": {
      "RetryCount": 5,
      "BaseDelaySeconds": 15,
      "BackoffMultiplier": 2
    }
  },

  "ParallelProcessing": {
    "EnableGpuAcceleration": false,
    "MaxCpuWorkers": 2,
    "BufferSize": 2048
  },

  "Metrics": {
    "Prometheus": {
      "Endpoint": "/metrics"
    }
  }
}