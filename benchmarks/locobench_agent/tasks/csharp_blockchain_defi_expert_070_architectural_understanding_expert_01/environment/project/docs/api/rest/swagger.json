{
  "openapi": "3.0.3",
  "info": {
    "title": "UtilityChain Core Suite – REST API",
    "description": "OpenAPI definition for the UtilityChain Core Suite monolith.  \nThis gateway exposes wallet, staking, governance, NFT and smart–contract features through a unified REST interface.",
    "version": "1.0.0",
    "termsOfService": "https://utilitychain.local/terms",
    "contact": {
      "name": "UtilityChain Engineering",
      "url": "https://utilitychain.local",
      "email": "support@utilitychain.local"
    },
    "license": {
      "name": "Business-Source License 1.1",
      "url": "https://utilitychain.local/license"
    }
  },
  "servers": [
    {
      "url": "https://api.utilitychain.local",
      "description": "Production"
    },
    {
      "url": "https://sandbox.utilitychain.local",
      "description": "Sandbox"
    }
  ],
  "tags": [
    { "name": "Health", "description": "Service health & diagnostics" },
    { "name": "Wallet", "description": "Key-pair, balance and transfer endpoints" },
    { "name": "Staking", "description": "Delegations, validators and rewards" },
    { "name": "Governance", "description": "Proposals, votes & referendum results" },
    { "name": "NFT", "description": "Non-fungible token management" },
    { "name": "Contract", "description": "Smart-contract execution" }
  ],
  "paths": {
    "/api/v1/health": {
      "get": {
        "tags": [ "Health" ],
        "summary": "Service health check",
        "responses": {
          "200": {
            "description": "Alive",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/HealthStatus" }
              }
            }
          }
        }
      }
    },
    "/api/v1/wallets": {
      "get": {
        "tags": [ "Wallet" ],
        "summary": "List wallets owned by the authenticated principal",
        "security": [ { "bearerAuth": [] } ],
        "responses": {
          "200": {
            "description": "Paged wallet list",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/PagedWalletList" }
              }
            }
          }
        }
      },
      "post": {
        "tags": [ "Wallet" ],
        "summary": "Create new wallet",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/WalletCreateRequest" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Wallet created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Wallet" }
              }
            }
          },
          "409": { "description": "Alias already exists" }
        }
      }
    },
    "/api/v1/wallets/{address}": {
      "get": {
        "tags": [ "Wallet" ],
        "summary": "Get wallet by address",
        "security": [ { "bearerAuth": [] } ],
        "parameters": [
          { "$ref": "#/components/parameters/AddressParam" }
        ],
        "responses": {
          "200": {
            "description": "Wallet details",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Wallet" }
              }
            }
          },
          "404": { "description": "Wallet not found" }
        }
      }
    },
    "/api/v1/wallets/{address}/balance": {
      "get": {
        "tags": [ "Wallet" ],
        "summary": "Get wallet balance",
        "security": [ { "bearerAuth": [] } ],
        "parameters": [
          { "$ref": "#/components/parameters/AddressParam" }
        ],
        "responses": {
          "200": {
            "description": "Current balance snapshot",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Balance" }
              }
            }
          },
          "404": { "description": "Wallet not found" }
        }
      }
    },
    "/api/v1/transactions": {
      "post": {
        "tags": [ "Wallet" ],
        "summary": "Submit a transfer transaction",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/TransactionRequest" }
            }
          }
        },
        "responses": {
          "202": {
            "description": "Transaction accepted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/TransactionAccepted" }
              }
            }
          },
          "400": { "description": "Invalid transaction payload" }
        }
      }
    },
    "/api/v1/transactions/{hash}": {
      "get": {
        "tags": [ "Wallet" ],
        "summary": "Get transaction status",
        "parameters": [
          { "$ref": "#/components/parameters/TxHashParam" }
        ],
        "responses": {
          "200": {
            "description": "Transaction record",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Transaction" }
              }
            }
          },
          "404": { "description": "Transaction not found" }
        }
      }
    },
    "/api/v1/staking/delegations": {
      "get": {
        "tags": [ "Staking" ],
        "summary": "List delegations for account",
        "security": [ { "bearerAuth": [] } ],
        "responses": {
          "200": {
            "description": "Delegation list",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/PagedDelegationList" }
              }
            }
          }
        }
      },
      "post": {
        "tags": [ "Staking" ],
        "summary": "Delegate stake",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/DelegationRequest" }
            }
          }
        },
        "responses": {
          "202": { "description": "Delegation accepted" },
          "400": { "description": "Invalid request" }
        }
      }
    },
    "/api/v1/staking/rewards/{address}": {
      "get": {
        "tags": [ "Staking" ],
        "summary": "Get accumulated rewards for an address",
        "parameters": [
          { "$ref": "#/components/parameters/AddressParam" }
        ],
        "responses": {
          "200": {
            "description": "Reward details",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/RewardInfo" }
              }
            }
          },
          "404": { "description": "Address not found" }
        }
      }
    },
    "/api/v1/governance/proposals": {
      "get": {
        "tags": [ "Governance" ],
        "summary": "List proposals",
        "parameters": [
          {
            "name": "state",
            "in": "query",
            "schema": { "type": "string", "enum": [ "Open", "Closed", "Passed", "Rejected" ] },
            "description": "Filter by state"
          }
        ],
        "responses": {
          "200": {
            "description": "Proposal list",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/PagedProposalList" }
              }
            }
          }
        }
      },
      "post": {
        "tags": [ "Governance" ],
        "summary": "Submit new proposal",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProposalCreateRequest" }
            }
          }
        },
        "responses": {
          "201": { "description": "Proposal created" },
          "400": { "description": "Invalid proposal" }
        }
      }
    },
    "/api/v1/governance/proposals/{id}": {
      "get": {
        "tags": [ "Governance" ],
        "summary": "Get proposal by id",
        "parameters": [
          { "$ref": "#/components/parameters/ProposalIdParam" }
        ],
        "responses": {
          "200": {
            "description": "Proposal details",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Proposal" }
              }
            }
          },
          "404": { "description": "Proposal not found" }
        }
      }
    },
    "/api/v1/governance/proposals/{id}/vote": {
      "post": {
        "tags": [ "Governance" ],
        "summary": "Cast vote on a proposal",
        "security": [ { "bearerAuth": [] } ],
        "parameters": [
          { "$ref": "#/components/parameters/ProposalIdParam" }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/VoteRequest" }
            }
          }
        },
        "responses": {
          "202": { "description": "Vote accepted" },
          "400": { "description": "Invalid vote" }
        }
      }
    },
    "/api/v1/nfts/mint": {
      "post": {
        "tags": [ "NFT" ],
        "summary": "Mint a new NFT",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/NftMintRequest" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "NFT minted",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/NftToken" }
              }
            }
          }
        }
      }
    },
    "/api/v1/nfts/{tokenId}": {
      "get": {
        "tags": [ "NFT" ],
        "summary": "Get NFT token metadata",
        "parameters": [
          { "$ref": "#/components/parameters/TokenIdParam" }
        ],
        "responses": {
          "200": {
            "description": "NFT details",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/NftToken" }
              }
            }
          },
          "404": { "description": "Token not found" }
        }
      }
    },
    "/api/v1/contracts/execute": {
      "post": {
        "tags": [ "Contract" ],
        "summary": "Execute smart-contract method",
        "security": [ { "bearerAuth": [] } ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ContractExecutionRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Execution result",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ContractExecutionResult" }
              }
            }
          },
          "400": { "description": "Invalid execution request" }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "parameters": {
      "AddressParam": {
        "name": "address",
        "in": "path",
        "required": true,
        "schema": { "type": "string", "pattern": "^[13][a-km-zA-HJ-NP-Z0-9]{25,34}$" },
        "description": "Blockchain wallet address"
      },
      "TxHashParam": {
        "name": "hash",
        "in": "path",
        "required": true,
        "schema": { "type": "string", "pattern": "^[A-Fa-f0-9]{64}$" },
        "description": "Transaction hash"
      },
      "ProposalIdParam": {
        "name": "id",
        "in": "path",
        "required": true,
        "schema": { "type": "integer", "minimum": 0 },
        "description": "Proposal identifier"
      },
      "TokenIdParam": {
        "name": "tokenId",
        "in": "path",
        "required": true,
        "schema": { "type": "string" },
        "description": "NFT tokenId (hex or UUID)"
      }
    },
    "schemas": {
      "HealthStatus": {
        "type": "object",
        "properties": {
          "status": { "type": "string", "example": "Healthy" },
          "nodeHeight": { "type": "integer", "example": 125334 },
          "peerCount": { "type": "integer", "example": 14 },
          "version": { "type": "string", "example": "1.0.0+rev.45f9c21" },
          "timestamp": { "type": "string", "format": "date-time", "example": "2024-03-08T14:25:37Z" }
        },
        "required": [ "status", "timestamp" ]
      },
      "PagedResultMeta": {
        "type": "object",
        "properties": {
          "page": { "type": "integer", "example": 1 },
          "pageSize": { "type": "integer", "example": 25 },
          "total": { "type": "integer", "example": 120 }
        },
        "required": [ "page", "pageSize", "total" ]
      },
      "Wallet": {
        "type": "object",
        "properties": {
          "address": { "type": "string" },
          "alias": { "type": "string" },
          "createdAt": { "type": "string", "format": "date-time" }
        },
        "required": [ "address", "createdAt" ]
      },
      "WalletCreateRequest": {
        "type": "object",
        "properties": {
          "alias": { "type": "string", "maxLength": 64 }
        }
      },
      "PagedWalletList": {
        "allOf": [
          { "$ref": "#/components/schemas/PagedResultMeta" },
          {
            "type": "object",
            "properties": {
              "items": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Wallet" }
              }
            },
            "required": [ "items" ]
          }
        ]
      },
      "Balance": {
        "type": "object",
        "properties": {
          "confirmed": { "type": "string", "example": "1234.5678" },
          "unconfirmed": { "type": "string", "example": "10.0000" },
          "unit": { "type": "string", "example": "UCOIN" }
        },
        "required": [ "confirmed", "unit" ]
      },
      "TransactionRequest": {
        "type": "object",
        "properties": {
          "from": { "type": "string" },
          "to": { "type": "string" },
          "amount": { "type": "string", "example": "50.0000" },
          "fee": { "type": "string", "example": "0.0100" },
          "memo": { "type": "string", "maxLength": 256 }
        },
        "required": [ "from", "to", "amount" ]
      },
      "TransactionAccepted": {
        "type": "object",
        "properties": {
          "hash": { "type": "string" },
          "acceptedAt": { "type": "string", "format": "date-time" }
        }
      },
      "Transaction": {
        "type": "object",
        "properties": {
          "hash": { "type": "string" },
          "blockHeight": { "type": "integer" },
          "timestamp": { "type": "string", "format": "date-time" },
          "from": { "type": "string" },
          "to": { "type": "string" },
          "amount": { "type": "string" },
          "fee": { "type": "string" },
          "status": { "type": "string", "enum": [ "Pending", "Confirmed", "Failed" ] }
        },
        "required": [ "hash", "from", "to", "amount", "status" ]
      },
      "DelegationRequest": {
        "type": "object",
        "properties": {
          "validator": { "type": "string" },
          "amount": { "type": "string" },
          "autoCompound": { "type": "boolean", "default": true }
        },
        "required": [ "validator", "amount" ]
      },
      "Delegation": {
        "type": "object",
        "properties": {
          "validator": { "type": "string" },
          "delegator": { "type": "string" },
          "amount": { "type": "string" },
          "reward": { "type": "string" },
          "delegatedAt": { "type": "string", "format": "date-time" }
        }
      },
      "PagedDelegationList": {
        "allOf": [
          { "$ref": "#/components/schemas/PagedResultMeta" },
          {
            "type": "object",
            "properties": {
              "items": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Delegation" }
              }
            }
          }
        ]
      },
      "RewardInfo": {
        "type": "object",
        "properties": {
          "address": { "type": "string" },
          "available": { "type": "string" },
          "pending": { "type": "string" },
          "lastClaimed": { "type": "string", "format": "date-time" }
        }
      },
      "ProposalCreateRequest": {
        "type": "object",
        "properties": {
          "title": { "type": "string", "maxLength": 120 },
          "description": { "type": "string", "maxLength": 4096 },
          "deposit": { "type": "string", "example": "1000.0000" },
          "kind": { "type": "string", "enum": [ "Text", "ParameterChange", "Upgrade" ] }
        },
        "required": [ "title", "description", "kind" ]
      },
      "Proposal": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "proposer": { "type": "string" },
          "state": { "type": "string", "enum": [ "Open", "Closed", "Passed", "Rejected" ] },
          "deposit": { "type": "string" },
          "createdAt": { "type": "string", "format": "date-time" },
          "tally": { "$ref": "#/components/schemas/VoteTally" }
        }
      },
      "VoteRequest": {
        "type": "object",
        "properties": {
          "option": { "type": "string", "enum": [ "Yes", "No", "Abstain", "Veto" ] }
        },
        "required": [ "option" ]
      },
      "VoteTally": {
        "type": "object",
        "properties": {
          "yes": { "type": "string" },
          "no": { "type": "string" },
          "abstain": { "type": "string" },
          "veto": { "type": "string" }
        }
      },
      "PagedProposalList": {
        "allOf": [
          { "$ref": "#/components/schemas/PagedResultMeta" },
          {
            "type": "object",
            "properties": {
              "items": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/Proposal" }
              }
            }
          }
        ]
      },
      "NftMintRequest": {
        "type": "object",
        "properties": {
          "recipient": { "type": "string" },
          "metadataUri": { "type": "string", "format": "uri" },
          "royaltyPercent": { "type": "integer", "minimum": 0, "maximum": 20 }
        },
        "required": [ "recipient", "metadataUri" ]
      },
      "NftToken": {
        "type": "object",
        "properties": {
          "tokenId": { "type": "string" },
          "owner": { "type": "string" },
          "metadataUri": { "type": "string", "format": "uri" },
          "royaltyPercent": { "type": "integer" },
          "mintedAt": { "type": "string", "format": "date-time" }
        }
      },
      "ContractExecutionRequest": {
        "type": "object",
        "properties": {
          "contractAddress": { "type": "string" },
          "method": { "type": "string" },
          "params": { "type": "object", "additionalProperties": true },
          "gasLimit": { "type": "integer" },
          "value": { "type": "string" }
        },
        "required": [ "contractAddress", "method" ]
      },
      "ContractExecutionResult": {
        "type": "object",
        "properties": {
          "transactionHash": { "type": "string" },
          "returnValue": { "type": "string" },
          "logs": {
            "type": "array",
            "items": { "type": "string" }
          },
          "gasUsed": { "type": "integer" },
          "status": { "type": "string", "enum": [ "Success", "Reverted" ] }
        }
      }
    }
  }
}