# =============================================================================
# HoloCanvas // config // default_node_config.toml
#
# Default configuration for a single HoloCanvas node.
#
# NOTE:
#   • All paths are absolute for clarity; feel free to override with env-vars
#     or relative paths in production overrides.
#   • Sensitive values (private keys, JWT secrets, etc.) should ultimately be
#     injected at runtime via a secret store (HashiCorp Vault, AWS SecretsMgr,
#     etc.) rather than committed in plaintext.
# =============================================================================

###############################################################################
# Node identity & general
###############################################################################
[node]
id            = "holo-node-001"                # Unique moniker for this node
chain_id      = "HoloCanvas-Mainnet"           # Chain/roll-up identifier
datadir       = "/var/lib/holocanvas"          # Root data directory
environment   = "production"                  # ["development", "staging", "production"]
enable_api    = true                           # Toggle full JSON-RPC/gRPC API set

###############################################################################
# Networking / P2P
###############################################################################
[network]
listen_address        = "0.0.0.0:9981"
advertised_address    = "node01.holocanvas.net:9981"
bootstrap_peers       = [
  "node02.holocanvas.net:9981",
  "node03.holocanvas.net:9981"
]
max_peer_connections  = 64                     # Hard upper-bound on active peers
handshake_timeout_ms  = 5_000
enable_encryption     = true                   # Noise-protocol encryption
enable_compression    = true                   # zstd compression for block propag.

###############################################################################
# Consensus
###############################################################################
[consensus]
engine                   = "pos_staking"       # ["pos_staking", "delegated_artistry"]
block_time_ms            = 2_500
epoch_length             = 2_048              # Blocks per validator rotation
validator_privkey_path   = "/etc/holocanvas/keys/validator.pem"
min_stake                = 1_000               # HLC minimum to enter validator set
slashing_penalty         = 0.05                # 5% stake slashed for equivocation
p2p_vote_timeout_ms      = 1_500
double_sign_slash_window = 50_000              # Blocks to look back for equiv.

###############################################################################
# Storage
###############################################################################
[storage]
db_backend              = "rocksdb"            # ["rocksdb", "badger", "boltdb"]
db_dir                  = "/var/lib/holocanvas/ledger"
prune                   = true
prune_keep_blocks       = 95_000
state_cache_size_mb     = 256
tx_index                = true                 # Enable tx lookup by hash
snapshot_interval       = 10_000               # Blocks between state snapshots

###############################################################################
# Security
###############################################################################
[security]
enable_tls              = true
tls_cert_file           = "/etc/holocanvas/certs/node.crt"
tls_key_file            = "/etc/holocanvas/certs/node.key"
jwt_secret_file         = "/etc/holocanvas/secrets/jwt_secret"
enable_dos_protection   = true
dos_max_req_per_min     = 1_200
password_pbkdf2_rounds  = 200_000

###############################################################################
# RPC / API
###############################################################################
[rpc]
enable                   = true
listen_address           = "0.0.0.0:8545"
cors_allowed_origins     = ["*"]
max_body_bytes           = 10_485_760          # 10 MiB
max_concurrent_requests  = 128
read_timeout_ms          = 8_000
write_timeout_ms         = 8_000
enable_ws                = true
ws_max_connections       = 512

###############################################################################
# Logging
###############################################################################
[logging]
level            = "INFO"                      # ["TRACE","DEBUG","INFO","WARN","ERROR"]
log_file         = "/var/log/holocanvas/node.log"
max_size_mb      = 100
max_backups      = 5
max_age_days     = 30
compress_backups = true
json_format      = false                       # Toggle structured logging

###############################################################################
# Inter-Service Endpoints (gRPC / Kafka topics)
###############################################################################
[microservices]
cryptograph      = "grpc://cryptograph.svc.cluster.local:7001"
ledgercore       = "grpc://ledgercore.svc.cluster.local:7002"
mint_factory     = "grpc://mint-factory.svc.cluster.local:7003"
gallery_gateway  = "grpc://gallery-gateway.svc.cluster.local:7004"
defi_garden      = "grpc://defi-garden.svc.cluster.local:7005"
oracle_bridge    = "grpc://oracle-bridge.svc.cluster.local:7006"
wallet_proxy     = "grpc://wallet-proxy.svc.cluster.local:7007"
governance_hall  = "grpc://governance-hall.svc.cluster.local:7008"

# Kafka topics used by Event-Driven mesh
[microservices.kafka]
brokers      = ["kafka01:9092", "kafka02:9092"]
topic_prefix = "holocanvas."
acks         = "all"
linger_ms    = 10
compression  = "zstd"

###############################################################################
# Feature flags
###############################################################################
[features]
enable_nft_fractionalization = true
enable_dao_governance        = true
enable_defi_staking          = true
enable_real_time_evolution   = true
enable_hardware_oracle       = true

###############################################################################
# Muse (Observer pattern) subsystem
###############################################################################
[muse_observers]
max_concurrent_muses     = 8
trigger_threshold_likes  = 100
trigger_threshold_bids   = 10

# Auto-approved content-evolution strategies
[muse_observers.auto_approve_strategies]
adaptive_color_shift = true
dynamic_audio_mix    = true

###############################################################################
# Oracle Bridge
###############################################################################
[oracle_bridge]
poll_interval_ms = 60_000
providers        = [
  "https://api.openweathermap.org",
  "https://chainlink.oracle"
]

###############################################################################
# Wallet Proxy
###############################################################################
[wallet_proxy]
session_timeout_minutes   = 30
max_concurrent_sessions   = 1_024
rate_limit_per_min        = 180
hardware_wallet_support   = true

###############################################################################
# Governance
###############################################################################
[governance]
quorum_percent        = 15.0                   # % of circulating supply
proposal_deposit_hlc  = 500
voting_period_blocks  = 10_000
timelock_blocks       = 1_000

###############################################################################
# Maintenance / Health
###############################################################################
[maintenance]
auto_upgrade              = true
healthcheck_interval_sec  = 30
backup_cron               = "0 3 * * *"       # Daily at 03:00

###############################################################################
# Metrics & Telemetry
###############################################################################
[metrics]
enable            = true
listen_address    = "0.0.0.0:9100"
prometheus_ns     = "holocanvas"
pushgateway_url   = ""                         # Empty ⇒ disabled

###############################################################################
# Experimental / toggles that may destabilize the node
###############################################################################
[experimental]
enable_delegate_artistry  = false
enable_ai_curation        = false
enable_zero_knowledge_fx  = false
enable_flash_minting      = false
enable_custom_vm          = false
###############################################################################
# End of file
###############################################################################