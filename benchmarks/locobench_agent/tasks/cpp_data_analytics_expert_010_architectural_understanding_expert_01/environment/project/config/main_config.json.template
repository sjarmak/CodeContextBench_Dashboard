{
  "application": {
    "name": "CardioInsight360",
    "environment": "{{ENVIRONMENT | default('production')}}",
    "version": "{{VERSION | default('1.0.0')}}",
    "instance_id": "{{INSTANCE_ID | env}}",
    "shutdown_grace_period_ms": 10000
  },

  "logging": {
    "level": "{{LOG_LEVEL | default('INFO')}}",
    "pattern": "%Y-%m-%d %H:%M:%S.%e [%t] %l %n: %v",
    "rotate": {
      "max_size_mb": 100,
      "max_files": 10,
      "compress": true
    }
  },

  "security": {
    "encryption_at_rest": true,
    "encryption_in_transit": true,
    "ssl": {
      "cert_file": "{{SSL_CERT_FILE | env}}",
      "key_file": "{{SSL_KEY_FILE | env}}",
      "ca_file": "{{SSL_CA_FILE | env}}",
      "verify_peer": true,
      "cipher_suites": "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256"
    },
    "token_auth": {
      "issuer": "CardioInsight360",
      "jwks_uri": "{{JWKS_URI | env}}",
      "audience": ["cardio", "cli"]
    }
  },

  "streaming": {
    "kafka": {
      "brokers": "{{KAFKA_BROKERS | default('localhost:9092')}}",
      "client_id": "{{CLIENT_ID | default('ci360-analytics')}}",
      "group_id": "{{GROUP_ID | default('ci360-core')}}",
      "topics": {
        "ingest_raw": "ci360.ingest.raw",
        "ingest_dlq": "ci360.ingest.dlq",
        "transform": "ci360.transform",
        "alert": "ci360.alert"
      },
      "connection": {
        "socket_keepalive_enable": true,
        "enable_idempotence": true,
        "compression_type": "lz4",
        "security_protocol": "SSL",
        "ssl": {
          "keystore_location": "{{KAFKA_KEYSTORE | env}}",
          "keystore_password": "{{KAFKA_KEYSTORE_PASS | vault}}",
          "truststore_location": "{{KAFKA_TRUSTSTORE | env}}",
          "truststore_password": "{{KAFKA_TRUSTSTORE_PASS | vault}}"
        }
      },
      "tuning": {
        "queue_buffering_max_ms": 5,
        "batch_num_messages": 10000,
        "fetch_min_bytes": 1,
        "fetch_max_wait_ms": 100
      },
      "schema_registry": {
        "url": "{{SCHEMA_REGISTRY_URL | default('https://schema-registry:8081')}}",
        "basic_auth": {
          "username": "{{SCHEMA_REGISTRY_USER | vault}}",
          "password": "{{SCHEMA_REGISTRY_PASS | vault}}"
        }
      }
    }
  },

  "data_lake": {
    "root_path": "{{DATA_LAKE_ROOT | default('/var/opt/ci360/data_lake')}}",
    "format": "parquet",
    "partitioning": ["year", "month", "day"],
    "replication_factor": 1,
    "read_only_mode": false
  },

  "database": {
    "type": "postgresql",
    "dsn": "postgresql://{{DB_USER | vault}}:{{DB_PASS | vault}}@{{DB_HOST | default('localhost')}}:{{DB_PORT | default('5432')}}/{{DB_NAME | default('ci360')}}",
    "pool": {
      "min_size": 4,
      "max_size": 32,
      "idle_timeout_ms": 30000
    },
    "sslmode": "require"
  },

  "etl": {
    "pipeline": {
      "max_concurrency": "{{MAX_CONCURRENCY | default('auto')}}",
      "queue_depth": 2048,
      "strategy_policy_dir": "{{POLICY_DIR | default('/etc/ci360/policies')}}",
      "retry_policy": {
        "max_retries": 3,
        "backoff_ms": 500
      }
    },
    "validation": {
      "arrhythmia_beat_classification": {
        "enabled": true,
        "threshold": 0.92
      }
    }
  },

  "monitoring": {
    "metrics_port": 9100,
    "expose_process_metrics": true,
    "sampling_interval_ms": 1000,
    "observers": [
      "ingestion_rate",
      "pipeline_lag",
      "kafka_consumer_group_offset",
      "db_open_connections"
    ]
  },

  "alerting": {
    "enabled": true,
    "smtp": {
      "server": "{{SMTP_SERVER | env}}",
      "port": 587,
      "username": "{{SMTP_USER | vault}}",
      "password": "{{SMTP_PASS | vault}}",
      "from": "ci360-alert@hospital.org",
      "to": ["biomed@hospital.org", "it-ops@hospital.org"],
      "use_tls": true
    },
    "thresholds": {
      "pipeline_failure_rate": 0.05,
      "disk_utilization": 0.90
    }
  },

  "resources": {
    "memory_soft_limit_mb": 4096,
    "memory_hard_limit_mb": 8192,
    "cpu_affinity": "all",
    "numa_aware": true
  },

  "feature_flags": {
    "enable_wearable_ecg_support": true,
    "enable_inline_visualization": false,
    "enable_streaming_ingress": true
  },

  "maintenance": {
    "auto_vacuum": {
      "enabled": true,
      "run_at_local_time": "03:00"
    },
    "data_lake_cleanup": {
      "enabled": true,
      "retain_days": 365
    },
    "log_rotation": {
      "enabled": true,
      "retain_files": 30
    }
  }
}