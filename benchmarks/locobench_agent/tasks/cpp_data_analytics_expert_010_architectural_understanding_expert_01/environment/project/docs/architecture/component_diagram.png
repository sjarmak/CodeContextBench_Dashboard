```cpp
//--------------------------------------------------------------------------------------------------
// File:    cardio_insight_360/tools/component_diagram_generator.cpp
// Purpose: Generates a high-level component diagram (PNG) for CardioInsight360’s documentation
// Language: C++17
//
// Build:
//   mkdir -p build && cd build
//   g++ -std=c++17 -O2 -Wall -Wextra -pedantic -o component_diagram_generator \
//       ../cardio_insight_360/tools/component_diagram_generator.cpp
//
// Usage:
//   ./component_diagram_generator                                          # Generates docs/architecture/component_diagram.{dot,png}
//
// Requirements:
//   • Graphviz CLI (`dot`) must be installed and accessible in PATH
//
// NOTE: The generated PNG is purely documentation-level; it is NOT linked into the production
//       binary. Placing this generator alongside the codebase keeps the diagram version-controlled
//       and automatically up-to-date with architectural changes.
//--------------------------------------------------------------------------------------------------
#include <cstdlib>          // std::system
#include <exception>
#include <fstream>
#include <iostream>
#include <sstream>
#include <stdexcept>
#include <string>
#include <string_view>
#include <filesystem>       // C++17

namespace fs = std::filesystem;

//--------------------------------------------------------------------------------------------------
// Helpers
//--------------------------------------------------------------------------------------------------
namespace util {

/**
 * @brief Execute a shell command, throwing std::runtime_error on non-zero exit status.
 *
 * @param cmd Command line to execute.
 */
void exec_or_throw(const std::string& cmd)
{
    const int rc = std::system(cmd.c_str());
    if (rc != 0) {
        std::ostringstream oss;
        oss << "Command '" << cmd << "' exited with status " << rc;
        throw std::runtime_error(oss.str());
    }
}

/**
 * @brief Create directories recursively if they do not already exist.
 */
void ensure_directory(const fs::path& dir)
{
    std::error_code ec;
    if (!fs::exists(dir, ec)) {
        if (!fs::create_directories(dir, ec)) {
            throw std::runtime_error(
                "Failed to create directory '" + dir.string() + "': " + ec.message());
        }
    }
}

} // namespace util

//--------------------------------------------------------------------------------------------------
// Diagram Generator
//--------------------------------------------------------------------------------------------------
class ComponentDiagramGenerator
{
public:
    explicit ComponentDiagramGenerator(fs::path output_dir)
        : output_dir_(std::move(output_dir))
    {
        util::ensure_directory(output_dir_);
    }

    void generate()
    {
        const fs::path dot_file  = output_dir_ / "component_diagram.dot";
        const fs::path png_file  = output_dir_ / "component_diagram.png";

        write_dot_file(dot_file);
        render_png(dot_file, png_file);

        std::cout << "Component diagram successfully written to "
                  << fs::weakly_canonical(png_file) << '\n';
    }

private:
    void write_dot_file(const fs::path& dot_file) const
    {
        std::ofstream ofs(dot_file);
        if (!ofs) {
            throw std::runtime_error("Unable to open file for writing: " + dot_file.string());
        }

        // clang-format off
        ofs << R"(digraph CardioInsight360 {
    rankdir = LR;
    graph [fontname = "Helvetica", fontsize=12, labelloc="t", label="CardioInsight360 – Component Diagram"];
    node  [fontname = "Helvetica", shape=rectangle, style=filled, fillcolor="#e1e8f0"];
    edge  [fontname = "Helvetica"];

    // Clusters group related subsystems
    subgraph cluster_ingest {
        label = "Ingestion Layer";
        style = "rounded,filled";
        color = "#d2e3f3";
        Ingest   [label="HL7 / FHIR Ingest"];
    }

    subgraph cluster_transform {
        label = "Transformation & Quality";
        style = "rounded,filled";
        color = "#f3ecd2";
        Validate [label="Data Validation"];
        Transform [label="Signal Transformation"];
    }

    subgraph cluster_stream {
        label = "Event Streaming";
        style = "rounded,filled";
        color = "#e2f3d2";
        EventBus [label="In-Process Kafka Bus"];
    }

    subgraph cluster_etl {
        label = "ETL Pipelines";
        style = "rounded,filled";
        color = "#f0d2e3";
        ETL      [label="Parallel ETL (Intel TBB)"];
    }

    subgraph cluster_storage {
        label = "Data Lake";
        style = "rounded,filled";
        color = "#d2f0f3";
        Storage  [label="Hierarchical Parquet Store"];
    }

    subgraph cluster_services {
        label = "Pseudo-Microservices";
        style = "rounded,filled";
        color = "#f3dcd2";
        Visualization [label="Visualization / Dashboards"];
        Monitoring    [label="Monitoring & Metrics"];
        Scheduling    [label="Scheduling Service"];
        ErrorRecovery [label="Error-Recovery Service"];
    }

    // Directed edges show primary data/control flow
    Ingest      -> Validate     [label="real-time"];
    Validate    -> Transform    [label="pass"];
    Transform   -> EventBus     [label="produce"];
    EventBus    -> ETL          [label="consume"];
    ETL         -> Storage      [label="write"];
    EventBus    -> Visualization [label="stream"];
    EventBus    -> Monitoring    [label="metrics"];
    ETL         -> Visualization [label="aggregate"];
    Scheduling  -> ETL          [label="trigger"];
    ErrorRecovery -> EventBus   [label="retry"];
})";
        // clang-format on

        ofs.close();
    }

    void render_png(const fs::path& dot_file, const fs::path& png_file) const
    {
        std::ostringstream cmd;
        cmd << "dot -Tpng " << dot_file.string() << " -o " << png_file.string();
        util::exec_or_throw(cmd.str());
    }

private:
    fs::path output_dir_;
};

//--------------------------------------------------------------------------------------------------
// Main
//--------------------------------------------------------------------------------------------------
int main(int argc, char** argv)
{
    try {
        // Default output directory inside repository
        fs::path output_dir = fs::path("cardio_insight_360") / "docs" / "architecture";
        if (argc > 1) { // Allow user-specified output directory
            output_dir = fs::path(argv[1]);
        }

        ComponentDiagramGenerator generator(output_dir);
        generator.generate();
        return EXIT_SUCCESS;
    }
    catch (const std::exception& ex) {
        std::cerr << "[component_diagram_generator] ERROR: " << ex.what() << '\n';
        return EXIT_FAILURE;
    }
}
```
