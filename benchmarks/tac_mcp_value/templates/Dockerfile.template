# TAC Task Wrapper Environment
# This Dockerfile wraps TheAgentCompany's pre-built task images for Harbor integration

ARG TAC_IMAGE=ghcr.io/theagentcompany/${TASK_NAME}-image:1.0.0
FROM ${TAC_IMAGE}

# TAC images are already set up with:
# - /utils/ containing init.sh, eval.py, evaluator.py.enc, common.py, scoring.py
# - /instruction/ containing task.md
# - /workspace/ as the working directory

# Create logs directory for Harbor compatibility
RUN mkdir -p /logs

# Copy our test wrapper script
COPY tests/test.sh /workspace/tests/test.sh
RUN chmod +x /workspace/tests/test.sh

# Set working directory
WORKDIR /workspace

# Environment variables for TAC server connection
# These should be provided at runtime
ENV TAC_SERVER_HOSTNAME=localhost
ENV LITELLM_API_KEY=""
ENV LITELLM_BASE_URL=""
ENV LITELLM_MODEL=""
ENV DECRYPTION_KEY="theagentcompany is all you need"

# Initialize TAC task environment on container start
# Note: This is usually run manually, but we include it for convenience
CMD ["bash"]
