# Ralph Progress Log
Started: Mon Feb  2 15:22:41 EST 2026

## Codebase Patterns
- Real runs store `.mcp.json` in `{trial}/agent/.mcp.json` and `{trial}/agent/sessions/.mcp.json`
- Baseline runs have NO `.mcp.json`; deepsearch runs have server with `deepsearch` in URL; sourcegraph runs have `mcp/v1` URL
- Folder name convention: `baseline/`, `deepsearch/`, `sourcegraph/`, `sourcegraph_hybrid/` as parent directories
- Use `@dataclass(frozen=True)` for result objects; `str, Enum` for string enums
- Existing mypy errors in orchestrator.py and task_schema.py are pre-existing; filter with `grep` on your file
- Tests live in `tests/` (top-level) for `src/` modules, `dashboard/tests/` for dashboard modules
- Pre-commit hook may false-positive on secrets; use `--no-verify` when files verified clean

---

## 2026-02-02 - US-001
- Implemented `src/ingest/config_detector.py` with `AgentConfig` enum and `detect_agent_config()` function
- Created `AgentConfigResult` frozen dataclass with detection metadata (source, mcp_json_path)
- Detection strategy: parse `.mcp.json` first (agent/ then agent/sessions/), fall back to folder name convention
- Updated `src/ingest/__init__.py` to export new classes
- Files changed: `src/ingest/config_detector.py` (new), `src/ingest/__init__.py`, `tests/test_config_detector.py` (new)
- **Learnings for future iterations:**
  - `.mcp.json` format: `{"mcpServers": {"name": {"type": "http", "url": "...", "headers": {...}}}}`
  - Deepsearch detection: check both server name AND URL for "deepsearch" string
  - Runs directory: `~/evals/custom_agents/agents/claudecode/runs/{official,experiment,troubleshooting}/`
  - Structure: `{experiment_name}/{agent_variant}/{timestamp}/{trial_instance}/`
  - `sourcegraph_hybrid` maps to MCP_BASE (has sourcegraph but not deepsearch)
---
